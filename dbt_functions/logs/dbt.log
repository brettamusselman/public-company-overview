[0m20:58:44.375205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADFFA58560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD82D64170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD831B48F0>]}


============================== 20:58:44.378195 | dd47bb25-3f65-4738-ae1f-62c216efc3df ==============================
[0m20:58:44.378195 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:58:44.378195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation stage_external_sources', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:58:45.293735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92FE8AD0>]}
[0m20:58:45.320735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD953F9F10>]}
[0m20:58:45.321734 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:58:45.533537 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:58:45.534537 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:58:45.534537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8328C110>]}
[0m20:58:46.825530 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_fmp_tickers' in the 'models' section of file 'models\staging\fmp\_stg_fmp_models.yml'
[0m20:58:46.988080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD95AE83E0>]}
[0m20:58:47.038083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m20:58:47.041591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m20:58:47.061590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD95ED4860>]}
[0m20:58:47.061590 [info ] [MainThread]: Found 20 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m20:58:47.061590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd47bb25-3f65-4738-ae1f-62c216efc3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD95A7AA20>]}
[0m20:58:47.062590 [debug] [MainThread]: Acquiring new bigquery connection 'macro_stage_external_sources'
[0m20:58:47.119592 [info ] [MainThread]: 1 of 10 START external source pco_dataset.stg_fmp__hist_ticker_daily
[0m20:58:47.123590 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:47.123590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:48.359527 [info ] [MainThread]: 1 of 10 SKIP
[0m20:58:48.644592 [info ] [MainThread]: 2 of 10 START external source pco_dataset.stg_fmp__tickers_ext
[0m20:58:48.645594 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:48.746623 [info ] [MainThread]: 2 of 10 SKIP
[0m20:58:49.114181 [info ] [MainThread]: 3 of 10 START external source pco_dataset.stg_fmp__exchanges_ext
[0m20:58:49.114181 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:49.255124 [info ] [MainThread]: 3 of 10 SKIP
[0m20:58:49.587495 [info ] [MainThread]: 4 of 10 START external source pco_dataset.stg_fmp__balance_sheet_ext
[0m20:58:49.588551 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:49.702844 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

    
        select * from `public-company-overview`.INFORMATION_SCHEMA.SCHEMATA where schema_name = 'pco_dataset' limit 1
    
  
[0m20:58:50.799557 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:4e8fa172-bdb7-43a5-8696-737769fd6aa5&page=queryresults
[0m20:58:51.536264 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

    
        select * from `public-company-overview`.INFORMATION_SCHEMA.SCHEMATA where schema_name = 'pco_dataset' limit 1
    
  
[0m20:58:52.115509 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:90fa6b33-de69-42d1-b5de-f9591b74d131&page=queryresults
[0m20:58:52.630752 [info ] [MainThread]: 4 of 10 (1) create schema if not exists `public-company-overview`.pco_dataset
[0m20:58:52.632752 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

                 create schema if not exists `public-company-overview`.pco_dataset
            
[0m20:58:52.855605 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:6c3f2417-754b-4048-8d50-6cd20120db9c&page=queryresults
[0m20:58:53.054536 [info ] [MainThread]: 4 of 10 (1) None (0 processed)
[0m20:58:53.055537 [info ] [MainThread]: 4 of 10 (2) create or replace external table `public-company-overview`.`pco_dataset`.`stg_fm...  
[0m20:58:53.055537 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

                 
    

    create or replace external table `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`(
            
                date STRING,
                symbol STRING,
                reportedCurrency STRING,
                cik STRING,
                fillingDate STRING,
                acceptedDate STRING,
                calendarYear STRING,
                period STRING,
                cashAndCashEquivalents STRING,
                shortTermInvestments STRING,
                cashAndShortTermInvestments STRING,
                netReceivables STRING,
                inventory STRING,
                otherCurrentAssets STRING,
                totalCurrentAssets STRING,
                propertyPlantEquipmentNet STRING,
                goodwill STRING,
                intangibleAssets STRING,
                goodwillAndIntangibleAssets STRING,
                longTermInvestments STRING,
                taxAssets STRING,
                otherNonCurrentAssets STRING,
                totalNonCurrentAssets STRING,
                otherAssets STRING,
                totalAssets STRING,
                accountPayables STRING,
                shortTermDebt STRING,
                taxPayables STRING,
                deferredRevenue STRING,
                otherCurrentLiabilities STRING,
                totalCurrentLiabilities STRING,
                longTermDebt STRING,
                deferredRevenueNonCurrent STRING,
                deferredTaxLiabilitiesNonCurrent STRING,
                otherNonCurrentLiabilities STRING,
                totalNonCurrentLiabilities STRING,
                otherLiabilities STRING,
                capitalLeaseObligations STRING,
                totalLiabilities STRING,
                preferredStock STRING,
                commonStock STRING,
                retainedEarnings STRING,
                accumulatedOtherComprehensiveIncomeLoss STRING,
                othertotalStockholdersEquity STRING,
                totalStockholdersEquity STRING,
                totalEquity STRING,
                totalLiabilitiesAndStockholdersEquity STRING,
                minorityInterest STRING,
                totalLiabilitiesAndTotalEquity STRING,
                totalInvestments STRING,
                totalDebt STRING,
                netDebt STRING,
                link STRING,
                finalLink STRING)
        
        
        
        options (
            uris = ['gs://dbt-testing/fmp/balance_sheet/*.csv'], format = 'csv', skip_leading_rows = 1)


            
[0m20:58:53.242879 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:87dfc161-94cc-4bc4-b23c-b4810fa78fb5&page=queryresults
[0m20:58:53.441938 [info ] [MainThread]: 4 of 10 (2) None (0 processed)
[0m20:58:53.771909 [info ] [MainThread]: 5 of 10 START external source pco_dataset.stg_polygon__hist_ticker_interval
[0m20:58:53.772909 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:53.877990 [info ] [MainThread]: 5 of 10 SKIP
[0m20:58:54.197756 [info ] [MainThread]: 6 of 10 START external source pco_dataset.stg_polygon__exchanges_ext
[0m20:58:54.198775 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:54.295928 [info ] [MainThread]: 6 of 10 SKIP
[0m20:58:54.567054 [info ] [MainThread]: 7 of 10 START external source pco_dataset.stg_polygon__tickers_ext
[0m20:58:54.568055 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:54.665687 [info ] [MainThread]: 7 of 10 SKIP
[0m20:58:54.928336 [info ] [MainThread]: 8 of 10 START external source pco_dataset.stg_yfinance__hist_ticker_daily
[0m20:58:54.929339 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:55.018160 [info ] [MainThread]: 8 of 10 SKIP
[0m20:58:55.291255 [info ] [MainThread]: 9 of 10 START external source pco_dataset.stg_yfinance__hist_ticker_interval
[0m20:58:55.292255 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:55.393311 [info ] [MainThread]: 9 of 10 SKIP
[0m20:58:55.653458 [info ] [MainThread]: 10 of 10 START external source pco_dataset.stg_yfinance__hist_tickers_interval
[0m20:58:55.654462 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m20:58:55.742408 [info ] [MainThread]: 10 of 10 SKIP
[0m20:58:56.032907 [debug] [MainThread]: Wrote artifact RunResultsArtifact to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m20:58:56.033907 [debug] [MainThread]: Command `dbt run-operation` succeeded at 20:58:56.033907 after 11.75 seconds
[0m20:58:56.033907 [debug] [MainThread]: Connection 'macro_stage_external_sources' was properly closed.
[0m20:58:56.033907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD95EE5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD830F11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD830F1B20>]}
[0m20:58:56.033907 [debug] [MainThread]: Flushing usage events
[0m20:58:56.094635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:25.601571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CFE19D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7D0AC1A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7D0AC30B0>]}


============================== 21:16:25.604576 | 81d3f9b2-b10d-4f5f-9f00-3f2ba7349e46 ==============================
[0m21:16:25.604576 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:16:25.604576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:26.190052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81d3f9b2-b10d-4f5f-9f00-3f2ba7349e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E2ADEEA0>]}
[0m21:16:26.218052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81d3f9b2-b10d-4f5f-9f00-3f2ba7349e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7D012D9D0>]}
[0m21:16:26.218052 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:16:26.417052 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:16:26.559053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m21:16:26.559053 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m21:16:26.559053 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:16:26.560054 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\_int_fmp_models.yml
[0m21:16:26.680130 [error] [MainThread]: Encountered an error:
Compilation Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  unexpected char '\xad' at 2
    line 1
      {{Â­
[0m21:16:26.681135 [debug] [MainThread]: Command `dbt run` failed at 21:16:26.681135 after 1.17 seconds
[0m21:16:26.681135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CFE19D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CE5BC9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E34413D0>]}
[0m21:16:26.681135 [debug] [MainThread]: Flushing usage events
[0m21:16:26.877892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:50.067706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238EC3BBCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238EC35E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238EC573860>]}


============================== 21:16:50.070706 | 6e71780d-458e-46cf-8a90-a09caf03a052 ==============================
[0m21:16:50.070706 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:16:50.070706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:50.637398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FEB5D1C0>]}
[0m21:16:50.665398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FD953B00>]}
[0m21:16:50.665398 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:16:50.856399 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:16:50.981398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m21:16:50.981398 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m21:16:50.981398 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:16:50.981398 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\_int_fmp_models.yml
[0m21:16:51.184399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FF637440>]}
[0m21:16:51.231399 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:16:51.233400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:16:51.250497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FF759940>]}
[0m21:16:51.251499 [info ] [MainThread]: Found 22 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:16:51.251499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FF765970>]}
[0m21:16:51.252497 [info ] [MainThread]: 
[0m21:16:51.252497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:51.253496 [info ] [MainThread]: 
[0m21:16:51.253496 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:16:51.254497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:16:51.254497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:52.510470 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:16:52.511470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:52.822685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FF4D0AD0>]}
[0m21:16:52.823684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:52.826684 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:16:52.826684 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m21:16:52.827684 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m21:16:52.827684 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:16:52.833684 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:16:52.838683 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:16:52.839684 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:16:52.874684 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%m/%d/%Y', `date`)            AS ReportDate,       
    PARSE_DATE('%m/%d/%Y', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%m/%d/%Y %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:16:52.875684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:16:53.454552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:9d284322-6939-40e8-9404-671742a48ac3&page=queryresults
[0m21:16:53.608208 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as FLOAT64)
 as CashAndCashEquivalents, 
      
    cast(null as FLOAT64)
 as ShortTermInvestments, 
      
    cast(null as FLOAT64)
 as CashAndShortTermInvestments, 
      
    cast(null as FLOAT64)
 as NetReceivables, 
      
    cast(null as FLOAT64)
 as Inventory, 
      
    cast(null as FLOAT64)
 as OtherCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalCurrentAssets, 
      
    cast(null as FLOAT64)
 as PPENet, 
      
    cast(null as FLOAT64)
 as Goodwill, 
      
    cast(null as FLOAT64)
 as IntangibleAssets, 
      
    cast(null as FLOAT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as FLOAT64)
 as LongTermInvestments, 
      
    cast(null as FLOAT64)
 as TaxAssets, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as OtherAssets, 
      
    cast(null as FLOAT64)
 as TotalAssets, 
      
    cast(null as FLOAT64)
 as AccountPayables, 
      
    cast(null as FLOAT64)
 as ShortTermDebt, 
      
    cast(null as FLOAT64)
 as TaxPayables, 
      
    cast(null as FLOAT64)
 as DeferredRevenue, 
      
    cast(null as FLOAT64)
 as OtherCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as LongTermDebt, 
      
    cast(null as FLOAT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as FLOAT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as OtherLiabilities, 
      
    cast(null as FLOAT64)
 as CapitalLeaseObligations, 
      
    cast(null as FLOAT64)
 as TotalLiabilities, 
      
    cast(null as FLOAT64)
 as PreferredStock, 
      
    cast(null as FLOAT64)
 as CommonStock, 
      
    cast(null as FLOAT64)
 as RetainedEarnings, 
      
    cast(null as FLOAT64)
 as AOCI, 
      
    cast(null as FLOAT64)
 as OtherSHEquity, 
      
    cast(null as FLOAT64)
 as TotalStockholdersEquity, 
      
    cast(null as FLOAT64)
 as TotalEquity, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as FLOAT64)
 as MinorityInterest, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as FLOAT64)
 as TotalInvestments, 
      
    cast(null as FLOAT64)
 as TotalDebt, 
      
    cast(null as FLOAT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:16:54.272967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:5f489c75-feb6-4bc3-852a-9b354d743cbd&page=queryresults
[0m21:16:54.487550 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:16:54.495549 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:16:54.497549 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    CashAndCashEquivalents FLOAT64,
    ShortTermInvestments FLOAT64,
    CashAndShortTermInvestments FLOAT64,
    NetReceivables FLOAT64,
    Inventory FLOAT64,
    OtherCurrentAssets FLOAT64,
    TotalCurrentAssets FLOAT64,
    PPENet FLOAT64,
    Goodwill FLOAT64,
    IntangibleAssets FLOAT64,
    GoodwillAndIntangibleAssets FLOAT64,
    LongTermInvestments FLOAT64,
    TaxAssets FLOAT64,
    OtherNonCurrentAssets FLOAT64,
    TotalNonCurrentAssets FLOAT64,
    OtherAssets FLOAT64,
    TotalAssets FLOAT64,
    AccountPayables FLOAT64,
    ShortTermDebt FLOAT64,
    TaxPayables FLOAT64,
    DeferredRevenue FLOAT64,
    OtherCurrentLiabilities FLOAT64,
    TotalCurrentLiabilities FLOAT64,
    LongTermDebt FLOAT64,
    DeferredRevenueNonCurrent FLOAT64,
    DeferredTaxLiabilitiesNonCurrent FLOAT64,
    OtherNonCurrentLiabilities FLOAT64,
    TotalNonCurrentLiabilities FLOAT64,
    OtherLiabilities FLOAT64,
    CapitalLeaseObligations FLOAT64,
    TotalLiabilities FLOAT64,
    PreferredStock FLOAT64,
    CommonStock FLOAT64,
    RetainedEarnings FLOAT64,
    AOCI FLOAT64,
    OtherSHEquity FLOAT64,
    TotalStockholdersEquity FLOAT64,
    TotalEquity FLOAT64,
    TotalLiabilitiesAndStockholdersEquity FLOAT64,
    MinorityInterest FLOAT64,
    TotalLiabilitiesAndTotalEquity FLOAT64,
    TotalInvestments FLOAT64,
    TotalDebt FLOAT64,
    NetDebt FLOAT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%m/%d/%Y', `date`)            AS ReportDate,       
    PARSE_DATE('%m/%d/%Y', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%m/%d/%Y %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as model_subq
    );
  
[0m21:16:54.870511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:4bf101a6-e928-4b01-8764-b593fbd6a6ed&page=queryresults
[0m21:16:55.371682 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:4bf101a6-e928-4b01-8764-b593fbd6a6ed&page=queryresults
[0m21:16:55.435549 [debug] [Thread-1 (]: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-09-30"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:16:55.436549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e71780d-458e-46cf-8a90-a09caf03a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FF7ACD10>]}
[0m21:16:55.437549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 2.61s]
[0m21:16:55.437549 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:16:55.438549 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-09-30"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql.
[0m21:16:55.439548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:55.439548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:55.440548 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:16:55.440548 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:16:55.440548 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m21:16:55.440548 [info ] [MainThread]: 
[0m21:16:55.440548 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m21:16:55.441549 [debug] [MainThread]: Command end result
[0m21:16:55.459547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:16:55.460547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:16:55.463550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:16:55.463550 [info ] [MainThread]: 
[0m21:16:55.463550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:16:55.464549 [info ] [MainThread]: 
[0m21:16:55.464549 [error] [MainThread]:   Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-09-30"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:16:55.464549 [info ] [MainThread]: 
[0m21:16:55.464549 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:16:55.465550 [debug] [MainThread]: Command `dbt run` failed at 21:16:55.465550 after 5.49 seconds
[0m21:16:55.465550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238ECBC6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238ECBC6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238ECBC5E80>]}
[0m21:16:55.465550 [debug] [MainThread]: Flushing usage events
[0m21:16:55.533210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:05.627343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DF6FD5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DF8168F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFADDF0B0>]}


============================== 21:18:05.629343 | 37220cdb-8cfa-4ad0-a334-e3ab58c11596 ==============================
[0m21:18:05.629343 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:18:05.630343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:06.178762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFB216060>]}
[0m21:18:06.206763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFA6D66C0>]}
[0m21:18:06.206763 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:18:06.405272 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:18:06.544272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:18:06.544272 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\_int_fmp_models.yml
[0m21:18:06.545272 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m21:18:06.753273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8DB50230>]}
[0m21:18:06.801274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:18:06.803275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:18:06.819272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8D888D10>]}
[0m21:18:06.820272 [info ] [MainThread]: Found 22 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:18:06.820272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8DBC9AF0>]}
[0m21:18:06.821273 [info ] [MainThread]: 
[0m21:18:06.821273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:06.821273 [info ] [MainThread]: 
[0m21:18:06.821273 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:18:06.822272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:18:06.822272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:07.825445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:18:07.825445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:08.032558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8D793AD0>]}
[0m21:18:08.033562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:08.035558 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:18:08.035558 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m21:18:08.036559 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m21:18:08.036559 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:18:08.042557 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:18:08.046557 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:18:08.047557 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:18:08.082558 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%m-%d-%Y', `date`)            AS ReportDate,       
    PARSE_DATE('%m-%d-%Y', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%m-%d-%Y %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:18:08.082558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:18:08.685565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:d376be59-9abe-4a51-ac7a-32a0b7536cfb&page=queryresults
[0m21:18:08.834044 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as FLOAT64)
 as CashAndCashEquivalents, 
      
    cast(null as FLOAT64)
 as ShortTermInvestments, 
      
    cast(null as FLOAT64)
 as CashAndShortTermInvestments, 
      
    cast(null as FLOAT64)
 as NetReceivables, 
      
    cast(null as FLOAT64)
 as Inventory, 
      
    cast(null as FLOAT64)
 as OtherCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalCurrentAssets, 
      
    cast(null as FLOAT64)
 as PPENet, 
      
    cast(null as FLOAT64)
 as Goodwill, 
      
    cast(null as FLOAT64)
 as IntangibleAssets, 
      
    cast(null as FLOAT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as FLOAT64)
 as LongTermInvestments, 
      
    cast(null as FLOAT64)
 as TaxAssets, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as OtherAssets, 
      
    cast(null as FLOAT64)
 as TotalAssets, 
      
    cast(null as FLOAT64)
 as AccountPayables, 
      
    cast(null as FLOAT64)
 as ShortTermDebt, 
      
    cast(null as FLOAT64)
 as TaxPayables, 
      
    cast(null as FLOAT64)
 as DeferredRevenue, 
      
    cast(null as FLOAT64)
 as OtherCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as LongTermDebt, 
      
    cast(null as FLOAT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as FLOAT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as OtherLiabilities, 
      
    cast(null as FLOAT64)
 as CapitalLeaseObligations, 
      
    cast(null as FLOAT64)
 as TotalLiabilities, 
      
    cast(null as FLOAT64)
 as PreferredStock, 
      
    cast(null as FLOAT64)
 as CommonStock, 
      
    cast(null as FLOAT64)
 as RetainedEarnings, 
      
    cast(null as FLOAT64)
 as AOCI, 
      
    cast(null as FLOAT64)
 as OtherSHEquity, 
      
    cast(null as FLOAT64)
 as TotalStockholdersEquity, 
      
    cast(null as FLOAT64)
 as TotalEquity, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as FLOAT64)
 as MinorityInterest, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as FLOAT64)
 as TotalInvestments, 
      
    cast(null as FLOAT64)
 as TotalDebt, 
      
    cast(null as FLOAT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:18:09.311312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:900eb046-19c9-445d-8c70-f674ac7f4a7e&page=queryresults
[0m21:18:09.545252 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:18:09.554252 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:18:09.554252 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    CashAndCashEquivalents FLOAT64,
    ShortTermInvestments FLOAT64,
    CashAndShortTermInvestments FLOAT64,
    NetReceivables FLOAT64,
    Inventory FLOAT64,
    OtherCurrentAssets FLOAT64,
    TotalCurrentAssets FLOAT64,
    PPENet FLOAT64,
    Goodwill FLOAT64,
    IntangibleAssets FLOAT64,
    GoodwillAndIntangibleAssets FLOAT64,
    LongTermInvestments FLOAT64,
    TaxAssets FLOAT64,
    OtherNonCurrentAssets FLOAT64,
    TotalNonCurrentAssets FLOAT64,
    OtherAssets FLOAT64,
    TotalAssets FLOAT64,
    AccountPayables FLOAT64,
    ShortTermDebt FLOAT64,
    TaxPayables FLOAT64,
    DeferredRevenue FLOAT64,
    OtherCurrentLiabilities FLOAT64,
    TotalCurrentLiabilities FLOAT64,
    LongTermDebt FLOAT64,
    DeferredRevenueNonCurrent FLOAT64,
    DeferredTaxLiabilitiesNonCurrent FLOAT64,
    OtherNonCurrentLiabilities FLOAT64,
    TotalNonCurrentLiabilities FLOAT64,
    OtherLiabilities FLOAT64,
    CapitalLeaseObligations FLOAT64,
    TotalLiabilities FLOAT64,
    PreferredStock FLOAT64,
    CommonStock FLOAT64,
    RetainedEarnings FLOAT64,
    AOCI FLOAT64,
    OtherSHEquity FLOAT64,
    TotalStockholdersEquity FLOAT64,
    TotalEquity FLOAT64,
    TotalLiabilitiesAndStockholdersEquity FLOAT64,
    MinorityInterest FLOAT64,
    TotalLiabilitiesAndTotalEquity FLOAT64,
    TotalInvestments FLOAT64,
    TotalDebt FLOAT64,
    NetDebt FLOAT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%m-%d-%Y', `date`)            AS ReportDate,       
    PARSE_DATE('%m-%d-%Y', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%m-%d-%Y %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as model_subq
    );
  
[0m21:18:09.853269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:fda89b29-dd02-4eb8-b22e-18ef74e9307e&page=queryresults
[0m21:18:10.182725 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:fda89b29-dd02-4eb8-b22e-18ef74e9307e&page=queryresults
[0m21:18:10.186725 [debug] [Thread-1 (]: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:18:10.187725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37220cdb-8cfa-4ad0-a334-e3ab58c11596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8DC92210>]}
[0m21:18:10.188725 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 2.15s]
[0m21:18:10.188725 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:18:10.189725 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql.
[0m21:18:10.190725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:10.190725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:10.190725 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:18:10.190725 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:18:10.190725 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m21:18:10.191725 [info ] [MainThread]: 
[0m21:18:10.191725 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m21:18:10.191725 [debug] [MainThread]: Command end result
[0m21:18:10.210725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:18:10.211726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:18:10.214724 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:18:10.214724 [info ] [MainThread]: 
[0m21:18:10.215725 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:18:10.215725 [info ] [MainThread]: 
[0m21:18:10.215725 [error] [MainThread]:   Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:18:10.216726 [info ] [MainThread]: 
[0m21:18:10.216726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:18:10.217725 [debug] [MainThread]: Command `dbt run` failed at 21:18:10.216726 after 4.68 seconds
[0m21:18:10.217725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFADDFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFAC3F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8DBED190>]}
[0m21:18:10.217725 [debug] [MainThread]: Flushing usage events
[0m21:18:10.407896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:58.974030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AA2587A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AC79F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AC79F290>]}


============================== 21:18:58.977030 | 7a1202e7-974d-4837-95e0-d99da2b79fe4 ==============================
[0m21:18:58.977030 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:18:58.977030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:59.532279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BF3051C0>]}
[0m21:18:59.560282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BCF2D7C0>]}
[0m21:18:59.560282 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:18:59.750281 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:18:59.882279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:59.882279 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m21:19:00.045279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BF51B500>]}
[0m21:19:00.093279 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:19:00.095281 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:19:00.110636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BF887CE0>]}
[0m21:19:00.110636 [info ] [MainThread]: Found 22 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:19:00.110636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BEFFA360>]}
[0m21:19:00.111634 [info ] [MainThread]: 
[0m21:19:00.112634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:00.112634 [info ] [MainThread]: 
[0m21:19:00.112634 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:19:00.113634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:19:00.113634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:01.122723 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:19:01.123723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:01.632318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BF37A810>]}
[0m21:19:01.632318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:01.635318 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:19:01.635318 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m21:19:01.635318 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m21:19:01.636318 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:19:01.643318 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:19:01.648318 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:19:01.648318 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:19:01.683318 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:19:01.684318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:19:02.278115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:8af7ea4a-6622-4cc9-a180-171388478d09&page=queryresults
[0m21:19:02.416490 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as FLOAT64)
 as CashAndCashEquivalents, 
      
    cast(null as FLOAT64)
 as ShortTermInvestments, 
      
    cast(null as FLOAT64)
 as CashAndShortTermInvestments, 
      
    cast(null as FLOAT64)
 as NetReceivables, 
      
    cast(null as FLOAT64)
 as Inventory, 
      
    cast(null as FLOAT64)
 as OtherCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalCurrentAssets, 
      
    cast(null as FLOAT64)
 as PPENet, 
      
    cast(null as FLOAT64)
 as Goodwill, 
      
    cast(null as FLOAT64)
 as IntangibleAssets, 
      
    cast(null as FLOAT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as FLOAT64)
 as LongTermInvestments, 
      
    cast(null as FLOAT64)
 as TaxAssets, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as OtherAssets, 
      
    cast(null as FLOAT64)
 as TotalAssets, 
      
    cast(null as FLOAT64)
 as AccountPayables, 
      
    cast(null as FLOAT64)
 as ShortTermDebt, 
      
    cast(null as FLOAT64)
 as TaxPayables, 
      
    cast(null as FLOAT64)
 as DeferredRevenue, 
      
    cast(null as FLOAT64)
 as OtherCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as LongTermDebt, 
      
    cast(null as FLOAT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as FLOAT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as OtherLiabilities, 
      
    cast(null as FLOAT64)
 as CapitalLeaseObligations, 
      
    cast(null as FLOAT64)
 as TotalLiabilities, 
      
    cast(null as FLOAT64)
 as PreferredStock, 
      
    cast(null as FLOAT64)
 as CommonStock, 
      
    cast(null as FLOAT64)
 as RetainedEarnings, 
      
    cast(null as FLOAT64)
 as AOCI, 
      
    cast(null as FLOAT64)
 as OtherSHEquity, 
      
    cast(null as FLOAT64)
 as TotalStockholdersEquity, 
      
    cast(null as FLOAT64)
 as TotalEquity, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as FLOAT64)
 as MinorityInterest, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as FLOAT64)
 as TotalInvestments, 
      
    cast(null as FLOAT64)
 as TotalDebt, 
      
    cast(null as FLOAT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:19:02.808185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:bbb55ec6-788d-425d-81d4-f9e6634b24ca&page=queryresults
[0m21:19:03.012654 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:19:03.021657 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:19:03.022655 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    CashAndCashEquivalents FLOAT64,
    ShortTermInvestments FLOAT64,
    CashAndShortTermInvestments FLOAT64,
    NetReceivables FLOAT64,
    Inventory FLOAT64,
    OtherCurrentAssets FLOAT64,
    TotalCurrentAssets FLOAT64,
    PPENet FLOAT64,
    Goodwill FLOAT64,
    IntangibleAssets FLOAT64,
    GoodwillAndIntangibleAssets FLOAT64,
    LongTermInvestments FLOAT64,
    TaxAssets FLOAT64,
    OtherNonCurrentAssets FLOAT64,
    TotalNonCurrentAssets FLOAT64,
    OtherAssets FLOAT64,
    TotalAssets FLOAT64,
    AccountPayables FLOAT64,
    ShortTermDebt FLOAT64,
    TaxPayables FLOAT64,
    DeferredRevenue FLOAT64,
    OtherCurrentLiabilities FLOAT64,
    TotalCurrentLiabilities FLOAT64,
    LongTermDebt FLOAT64,
    DeferredRevenueNonCurrent FLOAT64,
    DeferredTaxLiabilitiesNonCurrent FLOAT64,
    OtherNonCurrentLiabilities FLOAT64,
    TotalNonCurrentLiabilities FLOAT64,
    OtherLiabilities FLOAT64,
    CapitalLeaseObligations FLOAT64,
    TotalLiabilities FLOAT64,
    PreferredStock FLOAT64,
    CommonStock FLOAT64,
    RetainedEarnings FLOAT64,
    AOCI FLOAT64,
    OtherSHEquity FLOAT64,
    TotalStockholdersEquity FLOAT64,
    TotalEquity FLOAT64,
    TotalLiabilitiesAndStockholdersEquity FLOAT64,
    MinorityInterest FLOAT64,
    TotalLiabilitiesAndTotalEquity FLOAT64,
    TotalInvestments FLOAT64,
    TotalDebt FLOAT64,
    NetDebt FLOAT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS FLOAT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS FLOAT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS FLOAT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS FLOAT64) AS NetReceivables,
    CAST(inventory                     AS FLOAT64) AS Inventory,
    CAST(otherCurrentAssets            AS FLOAT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS FLOAT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS FLOAT64) AS PPENet,
    CAST(goodwill                      AS FLOAT64) AS Goodwill,
    CAST(intangibleAssets              AS FLOAT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS FLOAT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS FLOAT64) AS LongTermInvestments,
    CAST(taxAssets                     AS FLOAT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS FLOAT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS FLOAT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS FLOAT64) AS OtherAssets,

    CAST(accountPayables               AS FLOAT64) AS AccountPayables,
    CAST(shortTermDebt                 AS FLOAT64) AS ShortTermDebt,
    CAST(taxPayables                   AS FLOAT64) AS TaxPayables,
    CAST(deferredRevenue               AS FLOAT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS FLOAT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS FLOAT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS FLOAT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS FLOAT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS FLOAT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS FLOAT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS FLOAT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS FLOAT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS FLOAT64) AS TotalLiabilities,

    CAST(preferredStock                        AS FLOAT64) AS PreferredStock,
    CAST(commonStock                           AS FLOAT64) AS CommonStock,
    CAST(retainedEarnings                      AS FLOAT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS FLOAT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS FLOAT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS FLOAT64) AS TotalEquity,

    CAST(totalAssets                           AS FLOAT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS FLOAT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS FLOAT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS FLOAT64) AS TotalInvestments,
    CAST(totalDebt                             AS FLOAT64) AS TotalDebt,
    CAST(netDebt                               AS FLOAT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as model_subq
    );
  
[0m21:19:03.336244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:12de007d-fccb-4e13-bf02-79ef66cd9e03&page=queryresults
[0m21:19:05.120555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a1202e7-974d-4837-95e0-d99da2b79fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BF336450>]}
[0m21:19:05.121556 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model pco_dataset.int_fmp__balance_sheet ..... [[32mCREATE TABLE (2.2k rows, 1.3 MiB processed)[0m in 3.49s]
[0m21:19:05.122555 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:19:05.122555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:05.123556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:05.123556 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:19:05.123556 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:19:05.123556 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m21:19:05.123556 [info ] [MainThread]: 
[0m21:19:05.123556 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m21:19:05.124555 [debug] [MainThread]: Command end result
[0m21:19:05.143557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:19:05.144556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:19:05.147555 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:19:05.147555 [info ] [MainThread]: 
[0m21:19:05.147555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:05.148560 [info ] [MainThread]: 
[0m21:19:05.148560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:19:05.149556 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:05.149556 after 6.26 seconds
[0m21:19:05.149556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AC302450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AC6C2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147AC6C20F0>]}
[0m21:19:05.149556 [debug] [MainThread]: Flushing usage events
[0m21:19:05.202924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:49.800466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9A1387A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9A65EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9C629880>]}


============================== 21:27:49.802466 | b0570b7d-d87f-4de0-a84d-b8fe10e942cd ==============================
[0m21:27:49.802466 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:27:49.803466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim__tickers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:50.358286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0570b7d-d87f-4de0-a84d-b8fe10e942cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAF238B90>]}
[0m21:27:50.386286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0570b7d-d87f-4de0-a84d-b8fe10e942cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAF258590>]}
[0m21:27:50.386286 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:27:50.579286 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:27:50.711286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m21:27:50.711286 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:27:50.712286 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:27:50.712286 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__hist_ticker.sql
[0m21:27:50.827287 [error] [MainThread]: Encountered an error:
Compilation Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  unexpected char '\xad' at 2
    line 1
      {{Â­
[0m21:27:50.828286 [debug] [MainThread]: Command `dbt run` failed at 21:27:50.828286 after 1.12 seconds
[0m21:27:50.828286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9C8E8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9CCAF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAF8E99D0>]}
[0m21:27:50.828286 [debug] [MainThread]: Flushing usage events
[0m21:27:51.042185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:07.781984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8310E9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8310BBEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83189A7B0>]}


============================== 21:28:07.784560 | 90596caf-6d0b-4e8b-9c33-1bc0a180bf9a ==============================
[0m21:28:07.784560 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:28:07.784560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s dim__tickers', 'send_anonymous_usage_stats': 'True'}
[0m21:28:08.345171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8314DCF20>]}
[0m21:28:08.374171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8419EAF30>]}
[0m21:28:08.374171 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:28:08.564171 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:28:08.691171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m21:28:08.692171 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:28:08.692171 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:28:08.692171 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__hist_ticker.sql
[0m21:28:08.887171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F844490230>]}
[0m21:28:08.933682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:28:08.936683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:28:08.951683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84439BB60>]}
[0m21:28:08.951683 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:28:08.951683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843E41B20>]}
[0m21:28:08.952683 [info ] [MainThread]: 
[0m21:28:08.953682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:08.953682 [info ] [MainThread]: 
[0m21:28:08.953682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:28:08.954682 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:28:08.954682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:10.163919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:28:10.164918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:10.371195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843E1B290>]}
[0m21:28:10.372194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:10.374195 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.dim__tickers
[0m21:28:10.374195 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.dim__tickers .......................... [RUN]
[0m21:28:10.374195 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.dim__tickers'
[0m21:28:10.375197 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.dim__tickers
[0m21:28:10.378194 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.dim__tickers"
[0m21:28:10.379194 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.dim__tickers
[0m21:28:10.400195 [debug] [Thread-1 (]: On model.public_company_overview_dbt.dim__tickers: select * from (
        

WITH fmp_derived_tickers AS (
    SELECT
        *,
        'FMP' AS SourceSystem,
        1 AS source_priority
    FROM `public-company-overview`.`pco_dataset`.`dim_fmp__tickers`
),

polygon_derived_tickers AS (
    SELECT
        *,
        'Polygon' AS SourceSystem,
        2 AS source_priority
    FROM `public-company-overview`.`pco_dataset`.`dim_polygon__tickers` 
),

all_derived_tickers_unioned AS (
    SELECT * FROM fmp_derived_tickers
    UNION ALL
    SELECT * FROM polygon_derived_tickers
),

final_ranked_tickers AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey
            ORDER BY source_priority ASC, FileTimestamp DESC
        ) as rn
    FROM all_derived_tickers_unioned
)

SELECT
    TickerDimKey,
    Ticker,
    CompanyName,
    SourceSystem,
    FileTimestamp,
    DBTLoadedAtStaging,
    ExchangeDimKey,
    rn AS Rank       
FROM final_ranked_tickers
WHERE rn=1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:28:10.400195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:28:10.790142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:2bbe1a5a-1872-404b-b45e-2f5ab293adc2&page=queryresults
[0m21:28:10.929576 [debug] [Thread-1 (]: On model.public_company_overview_dbt.dim__tickers: select * from (
        select
    
      
    cast(null as STRING)
 as TickerDimKey, 
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as STRING)
 as CompanyName, 
      
    cast(null as STRING)
 as SourceSystem, 
      
    cast(null as INT64)
 as Rank, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging, 
      
    cast(null as STRING)
 as ExchangeDimKey
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:28:11.374000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:d97f8f1a-458f-4f79-aea6-f97c1dc6afc0&page=queryresults
[0m21:28:11.620379 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:11.624379 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:11.632380 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.dim__tickers"
[0m21:28:11.633380 [debug] [Thread-1 (]: On model.public_company_overview_dbt.dim__tickers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.dim__tickers"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`dim__tickers`
        
  (
    TickerDimKey STRING not null,
    Ticker STRING not null,
    CompanyName STRING,
    SourceSystem STRING not null,
    Rank INT64 not null,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    ExchangeDimKey STRING references `public-company-overview`.`pco_dataset`.`dim__exchanges` (ExchangeDimKey) not enforced,
    
    primary key (TickerDimKey) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select TickerDimKey, Ticker, CompanyName, SourceSystem, Rank, FileTimestamp, DBTLoadedAtStaging, ExchangeDimKey
    from (
        

WITH fmp_derived_tickers AS (
    SELECT
        *,
        'FMP' AS SourceSystem,
        1 AS source_priority
    FROM `public-company-overview`.`pco_dataset`.`dim_fmp__tickers`
),

polygon_derived_tickers AS (
    SELECT
        *,
        'Polygon' AS SourceSystem,
        2 AS source_priority
    FROM `public-company-overview`.`pco_dataset`.`dim_polygon__tickers` 
),

all_derived_tickers_unioned AS (
    SELECT * FROM fmp_derived_tickers
    UNION ALL
    SELECT * FROM polygon_derived_tickers
),

final_ranked_tickers AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey
            ORDER BY source_priority ASC, FileTimestamp DESC
        ) as rn
    FROM all_derived_tickers_unioned
)

SELECT
    TickerDimKey,
    Ticker,
    CompanyName,
    SourceSystem,
    FileTimestamp,
    DBTLoadedAtStaging,
    ExchangeDimKey,
    rn AS Rank       
FROM final_ranked_tickers
WHERE rn=1
    ) as model_subq
    );
  
[0m21:28:11.953521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:47496b3e-d573-41ba-b5bc-6323e890d46f&page=queryresults
[0m21:28:14.118490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90596caf-6d0b-4e8b-9c33-1bc0a180bf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843CC5D90>]}
[0m21:28:14.119492 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pco_dataset.dim__tickers ..................... [[32mCREATE TABLE (77.7k rows, 5.8 MiB processed)[0m in 3.74s]
[0m21:28:14.119492 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.dim__tickers
[0m21:28:14.120489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:14.121490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:14.121490 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:28:14.121490 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:28:14.121490 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.dim__tickers' was properly closed.
[0m21:28:14.121490 [info ] [MainThread]: 
[0m21:28:14.122488 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m21:28:14.122488 [debug] [MainThread]: Command end result
[0m21:28:14.140488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:28:14.141491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:28:14.144489 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:28:14.144489 [info ] [MainThread]: 
[0m21:28:14.144489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:14.145489 [info ] [MainThread]: 
[0m21:28:14.145489 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:28:14.146490 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:14.146490 after 6.45 seconds
[0m21:28:14.146490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F831170860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83189BF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8318BCFE0>]}
[0m21:28:14.146490 [debug] [MainThread]: Flushing usage events
[0m21:28:14.209051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:24.908532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96C271D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96C272AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96EA1C0E0>]}


============================== 21:28:24.911531 | ee67737a-220c-446e-8444-6c34e3b62b59 ==============================
[0m21:28:24.911531 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:28:24.911531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s fct__hist_ticker', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:28:25.462034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A97FE85670>]}
[0m21:28:25.490033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96E9070E0>]}
[0m21:28:25.490033 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:28:25.693033 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:28:25.821033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:25.821033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:25.849033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A901190B60>]}
[0m21:28:25.933033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:28:25.936035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:28:25.952034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9011D3860>]}
[0m21:28:25.952034 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:28:25.953034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A97F2BA480>]}
[0m21:28:25.953034 [info ] [MainThread]: 
[0m21:28:25.954033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:25.954033 [info ] [MainThread]: 
[0m21:28:25.955034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:28:25.955034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:28:25.956034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:26.952720 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:28:26.953719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:27.144655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A97FD163C0>]}
[0m21:28:27.144655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:27.146656 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__hist_ticker
[0m21:28:27.147656 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__hist_ticker ...................... [RUN]
[0m21:28:27.147656 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__hist_ticker'
[0m21:28:27.148655 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__hist_ticker
[0m21:28:27.154661 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__hist_ticker"
[0m21:28:27.154661 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__hist_ticker
[0m21:28:27.175655 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__hist_ticker: select * from (
        

WITH source_fmp AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,  
        EventDateTime,      
        Vwap,
        NULL AS Dividends,
        NULL AS StockSplits,
        NULL AS NumTransactions,
        Change,
        ChangePercent,
        Inter,
        FileTimestamp,
        DBTLoadedAtStaging,
        'FMP' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_fmp__hist_ticker`
),

source_polygon AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,
        EventDateTime,     
        Vwap,
        NULL AS Dividends,
        NULL AS StockSplits,
        NumTransactions,
        NULL AS Change,
        NULL AS ChangePercent,
        Inter,           
        FileTimestamp,
        DBTLoadedAtStaging,
        'Polygon' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_polygon__hist_ticker`
),

source_yfinance AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,
        EventDateTime,
        NULL AS Vwap,        
        Dividends,
        StockSplits,
        NULL AS NumTransactions,
        NULL AS Change,
        NULL AS ChangePercent,
        Inter,          
        FileTimestamp,
        DBTLoadedAtStaging,
        'YFinance' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_yfinance__hist_ticker`
),

all_sources_combined AS (
    SELECT * FROM source_fmp
    UNION ALL
    SELECT * FROM source_polygon
    UNION ALL
    SELECT * FROM source_yfinance
),

dim_date_lookup AS (
    SELECT
        DateDimKey, 
        EventDate  
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_time_lookup AS (
    SELECT
        TimeDimKey,  
        EventTime 
    FROM `public-company-overview`.`pco_dataset`.`dim__time`
),

dim_interval_lookup AS (
    SELECT
        IntervalDimKey,  
        IntervalValue     
    FROM `public-company-overview`.`pco_dataset`.`dim__interval` 
),

dim_tickers_lookup AS (
    SELECT
        TickerDimKey,  
        Ticker     
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers` 
),

joined_with_dimensions AS (
    SELECT
        asc_data.*,
        ddl.DateDimKey,
        dtl.TimeDimKey,
        dil.IntervalDimKey,
        dtkl.TickerDimKey
    FROM all_sources_combined asc_data
    LEFT JOIN dim_date_lookup ddl
        ON CAST(asc_data.EventDateTime AS DATE) = ddl.EventDate
    LEFT JOIN dim_time_lookup dtl
        ON CAST(asc_data.EventDateTime AS TIME) = dtl.EventTime
    LEFT JOIN dim_interval_lookup dil
        ON asc_data.Inter = dil.IntervalValue
    LEFT JOIN dim_tickers_lookup dtkl
        ON asc_data.Ticker = dtkl.Ticker
),

ranked_combined_data AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, TimeDimKey, IntervalDimKey
            ORDER BY FileTimestamp DESC
        ) as RecencyRank
    FROM
        joined_with_dimensions
)

SELECT
    TickerDimKey,
    IntervalDimKey,
    DateDimKey,
    TimeDimKey,
    `Open`,
    High,
    Low,
    `Close`,
    Volume,
    Vwap,
    NumTransactions,
    Dividends,
    StockSplits,
    Change,
    ChangePercent,
    FileTimestamp,    
    DBTLoadedAtStaging, 
    DataSource,         
    RecencyRank         
FROM
    ranked_combined_data
WHERE
    RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:28:27.175655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:28:27.664806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:762ff0c4-a8aa-4a05-9e3c-90e8100bec0a&page=queryresults
[0m21:28:27.814297 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__hist_ticker: select * from (
        select
    
      
    cast(null as FLOAT64)
 as Open, 
      
    cast(null as FLOAT64)
 as High, 
      
    cast(null as FLOAT64)
 as Low, 
      
    cast(null as FLOAT64)
 as Close, 
      
    cast(null as INT64)
 as Volume, 
      
    cast(null as FLOAT64)
 as Vwap, 
      
    cast(null as FLOAT64)
 as Change, 
      
    cast(null as FLOAT64)
 as ChangePercent, 
      
    cast(null as INT64)
 as NumTransactions, 
      
    cast(null as FLOAT64)
 as Dividends, 
      
    cast(null as FLOAT64)
 as StockSplits, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging, 
      
    cast(null as INT64)
 as RecencyRank, 
      
    cast(null as STRING)
 as IntervalDimKey, 
      
    cast(null as STRING)
 as DataSource, 
      
    cast(null as INT64)
 as DateDimKey, 
      
    cast(null as INT64)
 as TimeDimKey, 
      
    cast(null as STRING)
 as TickerDimKey
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:28:28.173145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:3a077354-8ad7-4bee-a2af-1ed517cebf5f&page=queryresults
[0m21:28:28.351821 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:28.352820 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:28.352820 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:28.353819 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:28.357819 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:28:28.365821 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.fct__hist_ticker"
[0m21:28:28.366822 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__hist_ticker: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.fct__hist_ticker"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`fct__hist_ticker`
        
  (
    Open FLOAT64,
    High FLOAT64,
    Low FLOAT64,
    Close FLOAT64,
    Volume INT64,
    Vwap FLOAT64,
    Change FLOAT64,
    ChangePercent FLOAT64,
    NumTransactions INT64,
    Dividends FLOAT64,
    StockSplits FLOAT64,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    RecencyRank INT64,
    IntervalDimKey STRING not null references `public-company-overview`.`pco_dataset`.`dim__interval` (IntervalDimKey) not enforced,
    DataSource STRING,
    DateDimKey INT64 not null references `public-company-overview`.`pco_dataset`.`dim__date` (DateDimKey) not enforced,
    TimeDimKey INT64 not null references `public-company-overview`.`pco_dataset`.`dim__time` (TimeDimKey) not enforced,
    TickerDimKey STRING not null references `public-company-overview`.`pco_dataset`.`dim__tickers` (TickerDimKey) not enforced,
    
    primary key (TickerDimKey, DateDimKey, TimeDimKey, IntervalDimKey, RecencyRank) not enforced
    )

      
    
    cluster by TickerDimKey, IntervalDimKey, DateDimKey, TimeDimKey

    OPTIONS()
    as (
      
    select Open, High, Low, Close, Volume, Vwap, Change, ChangePercent, NumTransactions, Dividends, StockSplits, FileTimestamp, DBTLoadedAtStaging, RecencyRank, IntervalDimKey, DataSource, DateDimKey, TimeDimKey, TickerDimKey
    from (
        

WITH source_fmp AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,  
        EventDateTime,      
        Vwap,
        NULL AS Dividends,
        NULL AS StockSplits,
        NULL AS NumTransactions,
        Change,
        ChangePercent,
        Inter,
        FileTimestamp,
        DBTLoadedAtStaging,
        'FMP' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_fmp__hist_ticker`
),

source_polygon AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,
        EventDateTime,     
        Vwap,
        NULL AS Dividends,
        NULL AS StockSplits,
        NumTransactions,
        NULL AS Change,
        NULL AS ChangePercent,
        Inter,           
        FileTimestamp,
        DBTLoadedAtStaging,
        'Polygon' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_polygon__hist_ticker`
),

source_yfinance AS (
    SELECT
        `Close`,
        High,
        Low,
        `Open`,
        Volume,
        Ticker,
        EventDateTime,
        NULL AS Vwap,        
        Dividends,
        StockSplits,
        NULL AS NumTransactions,
        NULL AS Change,
        NULL AS ChangePercent,
        Inter,          
        FileTimestamp,
        DBTLoadedAtStaging,
        'YFinance' AS DataSource
    FROM
        `public-company-overview`.`pco_dataset`.`int_yfinance__hist_ticker`
),

all_sources_combined AS (
    SELECT * FROM source_fmp
    UNION ALL
    SELECT * FROM source_polygon
    UNION ALL
    SELECT * FROM source_yfinance
),

dim_date_lookup AS (
    SELECT
        DateDimKey, 
        EventDate  
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_time_lookup AS (
    SELECT
        TimeDimKey,  
        EventTime 
    FROM `public-company-overview`.`pco_dataset`.`dim__time`
),

dim_interval_lookup AS (
    SELECT
        IntervalDimKey,  
        IntervalValue     
    FROM `public-company-overview`.`pco_dataset`.`dim__interval` 
),

dim_tickers_lookup AS (
    SELECT
        TickerDimKey,  
        Ticker     
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers` 
),

joined_with_dimensions AS (
    SELECT
        asc_data.*,
        ddl.DateDimKey,
        dtl.TimeDimKey,
        dil.IntervalDimKey,
        dtkl.TickerDimKey
    FROM all_sources_combined asc_data
    LEFT JOIN dim_date_lookup ddl
        ON CAST(asc_data.EventDateTime AS DATE) = ddl.EventDate
    LEFT JOIN dim_time_lookup dtl
        ON CAST(asc_data.EventDateTime AS TIME) = dtl.EventTime
    LEFT JOIN dim_interval_lookup dil
        ON asc_data.Inter = dil.IntervalValue
    LEFT JOIN dim_tickers_lookup dtkl
        ON asc_data.Ticker = dtkl.Ticker
),

ranked_combined_data AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, TimeDimKey, IntervalDimKey
            ORDER BY FileTimestamp DESC
        ) as RecencyRank
    FROM
        joined_with_dimensions
)

SELECT
    TickerDimKey,
    IntervalDimKey,
    DateDimKey,
    TimeDimKey,
    `Open`,
    High,
    Low,
    `Close`,
    Volume,
    Vwap,
    NumTransactions,
    Dividends,
    StockSplits,
    Change,
    ChangePercent,
    FileTimestamp,    
    DBTLoadedAtStaging, 
    DataSource,         
    RecencyRank         
FROM
    ranked_combined_data
WHERE
    RecencyRank = 1
    ) as model_subq
    );
  
[0m21:28:28.683272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:351cfcef-2ef6-4f28-b428-4d232718cb64&page=queryresults
[0m21:28:30.790025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee67737a-220c-446e-8444-6c34e3b62b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A97FE465D0>]}
[0m21:28:30.791027 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pco_dataset.fct__hist_ticker ................. [[32mCREATE TABLE (344.0 rows, 3.7 MiB processed)[0m in 3.64s]
[0m21:28:30.792025 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__hist_ticker
[0m21:28:30.792025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:30.793026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:30.793026 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:28:30.793026 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:28:30.793026 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__hist_ticker' was properly closed.
[0m21:28:30.793026 [info ] [MainThread]: 
[0m21:28:30.793026 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m21:28:30.794026 [debug] [MainThread]: Command end result
[0m21:28:30.811025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:28:30.813028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:28:30.815025 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:28:30.816026 [info ] [MainThread]: 
[0m21:28:30.816026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:30.817026 [info ] [MainThread]: 
[0m21:28:30.817026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:28:30.818025 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:30.817026 after 5.99 seconds
[0m21:28:30.818025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96EC4AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96EAF2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A96E8CF110>]}
[0m21:28:30.818025 [debug] [MainThread]: Flushing usage events
[0m21:28:30.872128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:48.373206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC54687D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC7D6E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC7D6F1A0>]}


============================== 21:35:48.376207 | 2e6be33b-d2d3-4500-935f-9608f9201291 ==============================
[0m21:35:48.376207 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:35:48.376207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s fct__balance_sheet', 'send_anonymous_usage_stats': 'True'}
[0m21:35:48.952117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e6be33b-d2d3-4500-935f-9608f9201291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC795A1B0>]}
[0m21:35:48.980116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e6be33b-d2d3-4500-935f-9608f9201291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC7FDEC90>]}
[0m21:35:48.980116 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:35:49.173114 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:35:49.303114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:35:49.304114 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:35:49.304114 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:35:49.459114 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.public_company_overview_dbt.fct__balance_sheet' (models\marts\fact\fct__balance_sheet.sql) depends on a node named 'dim__ticker' which was not found
[0m21:35:49.460114 [debug] [MainThread]: Command `dbt run` failed at 21:35:49.460114 after 1.18 seconds
[0m21:35:49.461113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC7959340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC2041BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDAC62D50>]}
[0m21:35:49.461113 [debug] [MainThread]: Flushing usage events
[0m21:35:49.594578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:02.480323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B3A688C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B5FAF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B5FAF380>]}


============================== 21:36:02.482320 | 995e6185-9d75-427c-9c29-200274bccdb2 ==============================
[0m21:36:02.482320 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:36:02.483322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s dim__ticker', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:36:03.051006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995e6185-9d75-427c-9c29-200274bccdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8C2F740>]}
[0m21:36:03.079009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995e6185-9d75-427c-9c29-200274bccdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C87F3500>]}
[0m21:36:03.079009 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:36:03.276008 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:36:03.394006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:36:03.394006 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:36:03.394006 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:36:03.552008 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.public_company_overview_dbt.fct__balance_sheet' (models\marts\fact\fct__balance_sheet.sql) depends on a node named 'dim__ticker' which was not found
[0m21:36:03.553007 [debug] [MainThread]: Command `dbt run` failed at 21:36:03.553007 after 1.18 seconds
[0m21:36:03.553007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B5FAF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8BFA180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C922BD10>]}
[0m21:36:03.553007 [debug] [MainThread]: Flushing usage events
[0m21:36:03.624857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:31.732254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F3247B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F1419D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F11353D0>]}


============================== 21:36:31.734254 | ff7dfa76-ed8b-4ff1-af0d-25600916be57 ==============================
[0m21:36:31.734254 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:36:31.735253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fct__balance_sheet', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:32.304394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FFF4C2C0>]}
[0m21:36:32.332395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F420BB00>]}
[0m21:36:32.332395 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:36:32.523396 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:36:32.652394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:36:32.652394 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:36:32.652394 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:36:32.853396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786A20A70>]}
[0m21:36:32.901395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:36:32.904395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:36:32.917924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217869F1BB0>]}
[0m21:36:32.917924 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:36:32.918924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786B23590>]}
[0m21:36:32.919925 [info ] [MainThread]: 
[0m21:36:32.919925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:36:32.919925 [info ] [MainThread]: 
[0m21:36:32.919925 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:36:32.920925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:36:32.920925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:33.989092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:36:33.989092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:34.168099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786BAFE90>]}
[0m21:36:34.168099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:34.170890 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:34.170890 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__balance_sheet .................... [RUN]
[0m21:36:34.170890 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__balance_sheet'
[0m21:36:34.171894 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:34.177895 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m21:36:34.177895 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:34.198893 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = d.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, Period
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:36:34.198893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:34.511742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:127677a5-4730-47df-8c05-db072fd8c1ca&page=queryresults
[0m21:36:34.512744 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:127677a5-4730-47df-8c05-db072fd8c1ca&page=queryresults
[0m21:36:34.517743 [debug] [Thread-1 (]: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Name Ticker not found inside d at [37:23]
[0m21:36:34.518742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff7dfa76-ed8b-4ff1-af0d-25600916be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786ABB1A0>]}
[0m21:36:34.518742 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pco_dataset.fct__balance_sheet ........... [[31mERROR[0m in 0.35s]
[0m21:36:34.519745 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:34.519745 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.fct__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Name Ticker not found inside d at [37:23].
[0m21:36:34.520743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:34.521744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:34.521744 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:36:34.521744 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:36:34.521744 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__balance_sheet' was properly closed.
[0m21:36:34.521744 [info ] [MainThread]: 
[0m21:36:34.521744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m21:36:34.522745 [debug] [MainThread]: Command end result
[0m21:36:34.540742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:36:34.541744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:36:34.544742 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:36:34.544742 [info ] [MainThread]: 
[0m21:36:34.544742 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:36:34.545744 [info ] [MainThread]: 
[0m21:36:34.545744 [error] [MainThread]:   Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Name Ticker not found inside d at [37:23]
[0m21:36:34.545744 [info ] [MainThread]: 
[0m21:36:34.545744 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:36:34.546743 [debug] [MainThread]: Command `dbt run` failed at 21:36:34.546743 after 2.92 seconds
[0m21:36:34.546743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F3B3BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EFFB5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F3DACFE0>]}
[0m21:36:34.546743 [debug] [MainThread]: Flushing usage events
[0m21:36:34.599742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:50.615772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135E2CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1383434A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C138343410>]}


============================== 21:36:50.617832 | 094153a8-5158-4107-90a7-b7e03b776c3d ==============================
[0m21:36:50.617832 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:36:50.618831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s fct__balance_sheet', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:36:51.161777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1383F43B0>]}
[0m21:36:51.188777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1383CF0B0>]}
[0m21:36:51.189777 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:36:51.382778 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:36:51.514777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:36:51.514777 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:36:51.711777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14B5646E0>]}
[0m21:36:51.759777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:36:51.761777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:36:51.776247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14B474E90>]}
[0m21:36:51.776247 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:36:51.776247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14B3D8DA0>]}
[0m21:36:51.777247 [info ] [MainThread]: 
[0m21:36:51.778246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:36:51.778246 [info ] [MainThread]: 
[0m21:36:51.779246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:36:51.779246 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:36:51.780247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:52.730820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:36:52.730820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:52.950840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14B0DDE50>]}
[0m21:36:52.950840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:52.953840 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:52.953840 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__balance_sheet .................... [RUN]
[0m21:36:52.953840 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__balance_sheet'
[0m21:36:52.954841 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:52.958842 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m21:36:52.959842 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:52.979841 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, Period
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:36:52.979841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:53.265279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:5985cc0e-2b2b-4320-bc9d-fa377c9f62b5&page=queryresults
[0m21:36:53.266279 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:5985cc0e-2b2b-4320-bc9d-fa377c9f62b5&page=queryresults
[0m21:36:53.270282 [debug] [Thread-1 (]: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26]
[0m21:36:53.271279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '094153a8-5158-4107-90a7-b7e03b776c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14B8F7740>]}
[0m21:36:53.272280 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pco_dataset.fct__balance_sheet ........... [[31mERROR[0m in 0.32s]
[0m21:36:53.272280 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:36:53.273280 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.fct__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26].
[0m21:36:53.274279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:53.274279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:53.274279 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:36:53.274279 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:36:53.274279 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__balance_sheet' was properly closed.
[0m21:36:53.275280 [info ] [MainThread]: 
[0m21:36:53.275280 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m21:36:53.275280 [debug] [MainThread]: Command end result
[0m21:36:53.294281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:36:53.296280 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:36:53.299280 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:36:53.299280 [info ] [MainThread]: 
[0m21:36:53.299280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:36:53.300280 [info ] [MainThread]: 
[0m21:36:53.300280 [error] [MainThread]:   Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26]
[0m21:36:53.300280 [info ] [MainThread]: 
[0m21:36:53.301279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:36:53.301279 [debug] [MainThread]: Command `dbt run` failed at 21:36:53.301279 after 2.77 seconds
[0m21:36:53.301279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C138A4F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C138D92990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C138D903B0>]}
[0m21:36:53.301279 [debug] [MainThread]: Flushing usage events
[0m21:36:53.461071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:26.176104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4A3FD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4A902A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D46895A60>]}


============================== 21:37:26.178094 | 63e3c4b1-3e77-4ea7-bafb-00def12c1679 ==============================
[0m21:37:26.178094 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:37:26.179093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fct__balance_sheet', 'send_anonymous_usage_stats': 'True'}
[0m21:37:26.728944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4A44B7A0>]}
[0m21:37:26.757945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5B7645F0>]}
[0m21:37:26.758945 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:37:26.957944 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:37:27.099946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:37:27.099946 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:37:27.308945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5D128500>]}
[0m21:37:27.355945 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:37:27.358946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:37:27.373816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5D6C4F50>]}
[0m21:37:27.373816 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:37:27.373816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5D5FA690>]}
[0m21:37:27.374817 [info ] [MainThread]: 
[0m21:37:27.374817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:27.375816 [info ] [MainThread]: 
[0m21:37:27.375816 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:37:27.375816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:37:27.376816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:28.348559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:37:28.349559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:28.570659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5D677B00>]}
[0m21:37:28.571659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:28.573658 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:37:28.573658 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__balance_sheet .................... [RUN]
[0m21:37:28.573658 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__balance_sheet'
[0m21:37:28.574658 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__balance_sheet
[0m21:37:28.579658 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m21:37:28.580657 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__balance_sheet
[0m21:37:28.601657 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, `Period`
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:37:28.601657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:28.913751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:2987d55e-4bf6-4328-84f3-73f90ab04d6d&page=queryresults
[0m21:37:28.913751 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:2987d55e-4bf6-4328-84f3-73f90ab04d6d&page=queryresults
[0m21:37:28.917754 [debug] [Thread-1 (]: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26]
[0m21:37:28.918754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e3c4b1-3e77-4ea7-bafb-00def12c1679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4A3CC920>]}
[0m21:37:28.919755 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pco_dataset.fct__balance_sheet ........... [[31mERROR[0m in 0.34s]
[0m21:37:28.919755 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:37:28.919755 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.fct__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26].
[0m21:37:28.920756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:28.921755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:28.921755 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:37:28.921755 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:37:28.921755 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__balance_sheet' was properly closed.
[0m21:37:28.921755 [info ] [MainThread]: 
[0m21:37:28.922755 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m21:37:28.922755 [debug] [MainThread]: Command end result
[0m21:37:28.940754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:37:28.942755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:37:28.944755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:37:28.945758 [info ] [MainThread]: 
[0m21:37:28.945758 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:37:28.945758 [info ] [MainThread]: 
[0m21:37:28.945758 [error] [MainThread]:   Database Error in model fct__balance_sheet (models\marts\fact\fct__balance_sheet.sql)
  Unrecognized name: TickerDimKey at [44:26]
[0m21:37:28.946755 [info ] [MainThread]: 
[0m21:37:28.946755 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:37:28.947755 [debug] [MainThread]: Command `dbt run` failed at 21:37:28.946755 after 2.86 seconds
[0m21:37:28.947755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D5D87FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4AA7CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D4AA7EDE0>]}
[0m21:37:28.947755 [debug] [MainThread]: Flushing usage events
[0m21:37:29.012773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:10.330355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD5CB83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD859AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD85983B0>]}


============================== 21:38:10.333354 | f5878464-1e14-4138-9c3d-6ba39762364e ==============================
[0m21:38:10.333354 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:38:10.333354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s fct__balance_sheet', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:38:10.913606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD9CA81D0>]}
[0m21:38:10.942606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE9633740>]}
[0m21:38:10.942606 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:38:11.138607 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:38:11.283609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:11.283609 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m21:38:11.493606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEB57ACF0>]}
[0m21:38:11.541606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:38:11.543608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:38:11.558332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEB477E60>]}
[0m21:38:11.558332 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:38:11.558332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEAA4A2D0>]}
[0m21:38:11.560331 [info ] [MainThread]: 
[0m21:38:11.560331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:11.560331 [info ] [MainThread]: 
[0m21:38:11.560331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:38:11.561331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:38:11.561331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:12.623429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:38:12.624430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:12.799929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEB623DA0>]}
[0m21:38:12.799929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:12.801930 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:38:12.801930 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__balance_sheet .................... [RUN]
[0m21:38:12.802930 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__balance_sheet'
[0m21:38:12.802930 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__balance_sheet
[0m21:38:12.807932 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m21:38:12.808929 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__balance_sheet
[0m21:38:12.828930 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, `Period`
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:38:12.828930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:38:13.311788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:73888993-fbb6-49ce-ae68-8a378b69ce7c&page=queryresults
[0m21:38:13.452009 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as TickerDimKey, 
      
    cast(null as INT64)
 as DateDimKey, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as INT64)
 as RecencyRank, 
      
    cast(null as FLOAT64)
 as CashAndCashEquivalents, 
      
    cast(null as FLOAT64)
 as ShortTermInvestments, 
      
    cast(null as FLOAT64)
 as CashAndShortTermInvestments, 
      
    cast(null as FLOAT64)
 as NetReceivables, 
      
    cast(null as FLOAT64)
 as Inventory, 
      
    cast(null as FLOAT64)
 as OtherCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalCurrentAssets, 
      
    cast(null as FLOAT64)
 as PPENet, 
      
    cast(null as FLOAT64)
 as Goodwill, 
      
    cast(null as FLOAT64)
 as IntangibleAssets, 
      
    cast(null as FLOAT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as FLOAT64)
 as LongTermInvestments, 
      
    cast(null as FLOAT64)
 as TaxAssets, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentAssets, 
      
    cast(null as FLOAT64)
 as OtherAssets, 
      
    cast(null as FLOAT64)
 as TotalAssets, 
      
    cast(null as FLOAT64)
 as AccountPayables, 
      
    cast(null as FLOAT64)
 as ShortTermDebt, 
      
    cast(null as FLOAT64)
 as TaxPayables, 
      
    cast(null as FLOAT64)
 as DeferredRevenue, 
      
    cast(null as FLOAT64)
 as OtherCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as LongTermDebt, 
      
    cast(null as FLOAT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as FLOAT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as FLOAT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as FLOAT64)
 as OtherLiabilities, 
      
    cast(null as FLOAT64)
 as CapitalLeaseObligations, 
      
    cast(null as FLOAT64)
 as TotalLiabilities, 
      
    cast(null as FLOAT64)
 as PreferredStock, 
      
    cast(null as FLOAT64)
 as CommonStock, 
      
    cast(null as FLOAT64)
 as RetainedEarnings, 
      
    cast(null as FLOAT64)
 as AOCI, 
      
    cast(null as FLOAT64)
 as OtherSHEquity, 
      
    cast(null as FLOAT64)
 as TotalStockholdersEquity, 
      
    cast(null as FLOAT64)
 as TotalEquity, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as FLOAT64)
 as MinorityInterest, 
      
    cast(null as FLOAT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as FLOAT64)
 as TotalInvestments, 
      
    cast(null as FLOAT64)
 as TotalDebt, 
      
    cast(null as FLOAT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging, 
      
    cast(null as STRING)
 as DataSource
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:38:13.906944 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:84388ab3-41b2-4495-8d9a-6a5cb7ca5446&page=queryresults
[0m21:38:14.384432 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:38:14.385432 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:38:14.389431 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:38:14.396431 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m21:38:14.397431 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.fct__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`fct__balance_sheet`
        
  (
    TickerDimKey STRING not null references `public-company-overview`.`pco_dataset`.`dim__tickers` (TickerDimKey) not enforced,
    DateDimKey INT64 not null references `public-company-overview`.`pco_dataset`.`dim__date` (DateDimKey) not enforced,
    Period STRING not null,
    CalendarYear INT64,
    RecencyRank INT64,
    CashAndCashEquivalents FLOAT64,
    ShortTermInvestments FLOAT64,
    CashAndShortTermInvestments FLOAT64,
    NetReceivables FLOAT64,
    Inventory FLOAT64,
    OtherCurrentAssets FLOAT64,
    TotalCurrentAssets FLOAT64,
    PPENet FLOAT64,
    Goodwill FLOAT64,
    IntangibleAssets FLOAT64,
    GoodwillAndIntangibleAssets FLOAT64,
    LongTermInvestments FLOAT64,
    TaxAssets FLOAT64,
    OtherNonCurrentAssets FLOAT64,
    TotalNonCurrentAssets FLOAT64,
    OtherAssets FLOAT64,
    TotalAssets FLOAT64,
    AccountPayables FLOAT64,
    ShortTermDebt FLOAT64,
    TaxPayables FLOAT64,
    DeferredRevenue FLOAT64,
    OtherCurrentLiabilities FLOAT64,
    TotalCurrentLiabilities FLOAT64,
    LongTermDebt FLOAT64,
    DeferredRevenueNonCurrent FLOAT64,
    DeferredTaxLiabilitiesNonCurrent FLOAT64,
    OtherNonCurrentLiabilities FLOAT64,
    TotalNonCurrentLiabilities FLOAT64,
    OtherLiabilities FLOAT64,
    CapitalLeaseObligations FLOAT64,
    TotalLiabilities FLOAT64,
    PreferredStock FLOAT64,
    CommonStock FLOAT64,
    RetainedEarnings FLOAT64,
    AOCI FLOAT64,
    OtherSHEquity FLOAT64,
    TotalStockholdersEquity FLOAT64,
    TotalEquity FLOAT64,
    TotalLiabilitiesAndStockholdersEquity FLOAT64,
    MinorityInterest FLOAT64,
    TotalLiabilitiesAndTotalEquity FLOAT64,
    TotalInvestments FLOAT64,
    TotalDebt FLOAT64,
    NetDebt FLOAT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    DataSource STRING,
    
    primary key (TickerDimKey, DateDimKey, Period, RecencyRank) not enforced
    )

      
    
    cluster by TickerDimKey, DateDimKey

    OPTIONS()
    as (
      
    select TickerDimKey, DateDimKey, Period, CalendarYear, RecencyRank, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging, DataSource
    from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, `Period`
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as model_subq
    );
  
[0m21:38:14.707235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:c56c8f5d-1cbc-4b4f-bb9a-5001f2e3de9e&page=queryresults
[0m21:38:17.101299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5878464-1e14-4138-9c3d-6ba39762364e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEAD864B0>]}
[0m21:38:17.102302 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pco_dataset.fct__balance_sheet ............... [[32mCREATE TABLE (1.6k rows, 3.4 MiB processed)[0m in 4.30s]
[0m21:38:17.102302 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__balance_sheet
[0m21:38:17.103300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:17.104303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:17.104303 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:38:17.104303 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:38:17.104303 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__balance_sheet' was properly closed.
[0m21:38:17.104303 [info ] [MainThread]: 
[0m21:38:17.105300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m21:38:17.105300 [debug] [MainThread]: Command end result
[0m21:38:17.123299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:38:17.124300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:38:17.127300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:38:17.127300 [info ] [MainThread]: 
[0m21:38:17.127300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:38:17.128301 [info ] [MainThread]: 
[0m21:38:17.128301 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:38:17.129302 [debug] [MainThread]: Command `dbt run` succeeded at 21:38:17.129302 after 6.89 seconds
[0m21:38:17.129302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEAE5B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEAE58FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FEA903740>]}
[0m21:38:17.129302 [debug] [MainThread]: Flushing usage events
[0m21:38:17.258126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:12.445960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFBE74980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFEC3D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFE9812E0>]}


============================== 21:46:12.448960 | 9a9ac6e2-23bf-44a0-9112-67745a8c421c ==============================
[0m21:46:12.448960 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:46:12.448960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:46:12.993970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFE3BF200>]}
[0m21:46:13.021971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC90F06390>]}
[0m21:46:13.021971 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:46:13.211970 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:46:13.351351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:46:13.352351 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m21:46:13.352351 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\_int_fmp_models.yml
[0m21:46:13.352351 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m21:46:13.558352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC911089E0>]}
[0m21:46:13.607352 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:46:13.609352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:46:13.623869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC915441A0>]}
[0m21:46:13.623869 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m21:46:13.624870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC918196A0>]}
[0m21:46:13.625869 [info ] [MainThread]: 
[0m21:46:13.625869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:13.625869 [info ] [MainThread]: 
[0m21:46:13.626869 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:13.627869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m21:46:13.627869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:14.660393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m21:46:14.660393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:14.876038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC91583FE0>]}
[0m21:46:14.876038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:14.878038 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:46:14.879038 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m21:46:14.879038 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m21:46:14.879038 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:46:14.885039 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:46:14.889038 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:46:14.890040 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:46:14.925038 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS INT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS INT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS INT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS INT64) AS NetReceivables,
    CAST(inventory                     AS INT64) AS Inventory,
    CAST(otherCurrentAssets            AS INT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS INT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS INT64) AS PPENet,
    CAST(goodwill                      AS INT64) AS Goodwill,
    CAST(intangibleAssets              AS INT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS INT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS INT64) AS LongTermInvestments,
    CAST(taxAssets                     AS INT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS INT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS INT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS INT64) AS OtherAssets,

    CAST(accountPayables               AS INT64) AS AccountPayables,
    CAST(shortTermDebt                 AS INT64) AS ShortTermDebt,
    CAST(taxPayables                   AS INT64) AS TaxPayables,
    CAST(deferredRevenue               AS INT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS INT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS INT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS INT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS INT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS INT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS INT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS INT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS INT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS INT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS INT64) AS TotalLiabilities,

    CAST(preferredStock                        AS INT64) AS PreferredStock,
    CAST(commonStock                           AS INT64) AS CommonStock,
    CAST(retainedEarnings                      AS INT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS INT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS INT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS INT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS INT64) AS TotalEquity,

    CAST(totalAssets                           AS INT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS INT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS INT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS INT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS INT64) AS TotalInvestments,
    CAST(totalDebt                             AS INT64) AS TotalDebt,
    CAST(netDebt                               AS INT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:46:14.925038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:46:15.444705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:90c5a076-8493-49d1-bee9-b9c019bc581b&page=queryresults
[0m21:46:15.599713 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as INT64)
 as CashAndCashEquivalents, 
      
    cast(null as INT64)
 as ShortTermInvestments, 
      
    cast(null as INT64)
 as CashAndShortTermInvestments, 
      
    cast(null as INT64)
 as NetReceivables, 
      
    cast(null as INT64)
 as Inventory, 
      
    cast(null as INT64)
 as OtherCurrentAssets, 
      
    cast(null as INT64)
 as TotalCurrentAssets, 
      
    cast(null as INT64)
 as PPENet, 
      
    cast(null as INT64)
 as Goodwill, 
      
    cast(null as INT64)
 as IntangibleAssets, 
      
    cast(null as INT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as INT64)
 as LongTermInvestments, 
      
    cast(null as INT64)
 as TaxAssets, 
      
    cast(null as INT64)
 as OtherNonCurrentAssets, 
      
    cast(null as INT64)
 as TotalNonCurrentAssets, 
      
    cast(null as INT64)
 as OtherAssets, 
      
    cast(null as INT64)
 as TotalAssets, 
      
    cast(null as INT64)
 as AccountPayables, 
      
    cast(null as INT64)
 as ShortTermDebt, 
      
    cast(null as INT64)
 as TaxPayables, 
      
    cast(null as INT64)
 as DeferredRevenue, 
      
    cast(null as INT64)
 as OtherCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalCurrentLiabilities, 
      
    cast(null as INT64)
 as LongTermDebt, 
      
    cast(null as INT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as INT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as INT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as INT64)
 as OtherLiabilities, 
      
    cast(null as INT64)
 as CapitalLeaseObligations, 
      
    cast(null as INT64)
 as TotalLiabilities, 
      
    cast(null as INT64)
 as PreferredStock, 
      
    cast(null as INT64)
 as CommonStock, 
      
    cast(null as INT64)
 as RetainedEarnings, 
      
    cast(null as INT64)
 as AOCI, 
      
    cast(null as INT64)
 as OtherSHEquity, 
      
    cast(null as INT64)
 as TotalStockholdersEquity, 
      
    cast(null as INT64)
 as TotalEquity, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as INT64)
 as MinorityInterest, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as INT64)
 as TotalInvestments, 
      
    cast(null as INT64)
 as TotalDebt, 
      
    cast(null as INT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:46:16.121880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:99842454-4be5-4cc3-9eda-f767e881e54d&page=queryresults
[0m21:46:16.372256 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:46:16.381256 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m21:46:16.381256 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    CashAndCashEquivalents INT64,
    ShortTermInvestments INT64,
    CashAndShortTermInvestments INT64,
    NetReceivables INT64,
    Inventory INT64,
    OtherCurrentAssets INT64,
    TotalCurrentAssets INT64,
    PPENet INT64,
    Goodwill INT64,
    IntangibleAssets INT64,
    GoodwillAndIntangibleAssets INT64,
    LongTermInvestments INT64,
    TaxAssets INT64,
    OtherNonCurrentAssets INT64,
    TotalNonCurrentAssets INT64,
    OtherAssets INT64,
    TotalAssets INT64,
    AccountPayables INT64,
    ShortTermDebt INT64,
    TaxPayables INT64,
    DeferredRevenue INT64,
    OtherCurrentLiabilities INT64,
    TotalCurrentLiabilities INT64,
    LongTermDebt INT64,
    DeferredRevenueNonCurrent INT64,
    DeferredTaxLiabilitiesNonCurrent INT64,
    OtherNonCurrentLiabilities INT64,
    TotalNonCurrentLiabilities INT64,
    OtherLiabilities INT64,
    CapitalLeaseObligations INT64,
    TotalLiabilities INT64,
    PreferredStock INT64,
    CommonStock INT64,
    RetainedEarnings INT64,
    AOCI INT64,
    OtherSHEquity INT64,
    TotalStockholdersEquity INT64,
    TotalEquity INT64,
    TotalLiabilitiesAndStockholdersEquity INT64,
    MinorityInterest INT64,
    TotalLiabilitiesAndTotalEquity INT64,
    TotalInvestments INT64,
    TotalDebt INT64,
    NetDebt INT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    CAST(cashAndCashEquivalents        AS INT64) AS CashAndCashEquivalents,
    CAST(shortTermInvestments          AS INT64) AS ShortTermInvestments,
    CAST(cashAndShortTermInvestments   AS INT64) AS CashAndShortTermInvestments,
    CAST(netReceivables                AS INT64) AS NetReceivables,
    CAST(inventory                     AS INT64) AS Inventory,
    CAST(otherCurrentAssets            AS INT64) AS OtherCurrentAssets,
    CAST(totalCurrentAssets            AS INT64) AS TotalCurrentAssets,

    CAST(propertyPlantEquipmentNet     AS INT64) AS PPENet,
    CAST(goodwill                      AS INT64) AS Goodwill,
    CAST(intangibleAssets              AS INT64) AS IntangibleAssets,
    CAST(goodwillAndIntangibleAssets   AS INT64) AS GoodwillAndIntangibleAssets,
    CAST(longTermInvestments           AS INT64) AS LongTermInvestments,
    CAST(taxAssets                     AS INT64) AS TaxAssets,
    CAST(otherNonCurrentAssets         AS INT64) AS OtherNonCurrentAssets,
    CAST(totalNonCurrentAssets         AS INT64) AS TotalNonCurrentAssets,
    CAST(otherAssets                   AS INT64) AS OtherAssets,

    CAST(accountPayables               AS INT64) AS AccountPayables,
    CAST(shortTermDebt                 AS INT64) AS ShortTermDebt,
    CAST(taxPayables                   AS INT64) AS TaxPayables,
    CAST(deferredRevenue               AS INT64) AS DeferredRevenue,
    CAST(otherCurrentLiabilities       AS INT64) AS OtherCurrentLiabilities,
    CAST(totalCurrentLiabilities       AS INT64) AS TotalCurrentLiabilities,
    CAST(longTermDebt                  AS INT64) AS LongTermDebt,
    CAST(deferredRevenueNonCurrent     AS INT64) AS DeferredRevenueNonCurrent,
    CAST(deferredTaxLiabilitiesNonCurrent AS INT64)
                                            AS DeferredTaxLiabilitiesNonCurrent,
    CAST(otherNonCurrentLiabilities    AS INT64) AS OtherNonCurrentLiabilities,
    CAST(totalNonCurrentLiabilities    AS INT64) AS TotalNonCurrentLiabilities,
    CAST(otherLiabilities              AS INT64) AS OtherLiabilities,
    CAST(capitalLeaseObligations       AS INT64) AS CapitalLeaseObligations,
    CAST(totalLiabilities              AS INT64) AS TotalLiabilities,

    CAST(preferredStock                        AS INT64) AS PreferredStock,
    CAST(commonStock                           AS INT64) AS CommonStock,
    CAST(retainedEarnings                      AS INT64) AS RetainedEarnings,
    CAST(accumulatedOtherComprehensiveIncomeLoss AS INT64)
                                                AS AOCI,
    CAST(othertotalStockholdersEquity          AS INT64) AS OtherSHEquity,
    CAST(totalStockholdersEquity               AS INT64) AS TotalStockholdersEquity,
    CAST(totalEquity                           AS INT64) AS TotalEquity,

    CAST(totalAssets                           AS INT64) AS TotalAssets,
    CAST(totalLiabilitiesAndStockholdersEquity AS INT64) AS TotalLiabilitiesAndStockholdersEquity,
    CAST(minorityInterest                      AS INT64) AS MinorityInterest,
    CAST(totalLiabilitiesAndTotalEquity        AS INT64) AS TotalLiabilitiesAndTotalEquity,
    CAST(totalInvestments                      AS INT64) AS TotalInvestments,
    CAST(totalDebt                             AS INT64) AS TotalDebt,
    CAST(netDebt                               AS INT64) AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as model_subq
    );
  
[0m21:46:16.684825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:da67d362-c42e-48df-a9be-c3fbc29252df&page=queryresults
[0m21:46:17.149689 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:da67d362-c42e-48df-a9be-c3fbc29252df&page=queryresults
[0m21:46:17.153689 [debug] [Thread-1 (]: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Bad int64 value: 0.0
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:46:17.155689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9ac6e2-23bf-44a0-9112-67745a8c421c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC91A0B4A0>]}
[0m21:46:17.155689 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 2.28s]
[0m21:46:17.156689 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m21:46:17.156689 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Bad int64 value: 0.0
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql.
[0m21:46:17.157690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:17.157690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:17.158690 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m21:46:17.158690 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m21:46:17.158690 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m21:46:17.158690 [info ] [MainThread]: 
[0m21:46:17.158690 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m21:46:17.159690 [debug] [MainThread]: Command end result
[0m21:46:17.178688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m21:46:17.179690 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m21:46:17.182691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m21:46:17.182691 [info ] [MainThread]: 
[0m21:46:17.183691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:17.183691 [info ] [MainThread]: 
[0m21:46:17.183691 [error] [MainThread]:   Database Error in model int_fmp__balance_sheet (models\intermediate\fmp\int_fmp__balance_sheet.sql)
  Bad int64 value: 0.0
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__balance_sheet.sql
[0m21:46:17.184689 [info ] [MainThread]: 
[0m21:46:17.184689 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:46:17.184689 [debug] [MainThread]: Command `dbt run` failed at 21:46:17.184689 after 4.83 seconds
[0m21:46:17.185688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFE6D2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFE68D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFC8D8B30>]}
[0m21:46:17.185688 [debug] [MainThread]: Flushing usage events
[0m21:46:17.322328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:33.167339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140907DDCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014090A9EDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140907DFC50>]}


============================== 22:02:33.169338 | b597a776-40fb-49ba-ad1a-f088832ba5f0 ==============================
[0m22:02:33.169338 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:02:33.170336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'send_anonymous_usage_stats': 'True'}
[0m22:02:33.786743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014090C38B00>]}
[0m22:02:33.815250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A092B7D0>]}
[0m22:02:33.815250 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:02:34.013275 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:02:34.149788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:34.149788 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m22:02:34.311810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A2E590A0>]}
[0m22:02:34.359809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:02:34.362809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:02:34.378240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A31E0680>]}
[0m22:02:34.379240 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m22:02:34.379240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A34D3E00>]}
[0m22:02:34.380240 [info ] [MainThread]: 
[0m22:02:34.380240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:34.380240 [info ] [MainThread]: 
[0m22:02:34.381239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:34.381239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:02:34.381239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:35.548266 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:02:35.548266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:35.756904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A2DFA780>]}
[0m22:02:35.756904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:35.758904 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:02:35.759904 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m22:02:35.759904 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m22:02:35.759904 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:02:35.771904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:02:35.792113 [debug] [Thread-1 (]: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:02:35.793109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b597a776-40fb-49ba-ad1a-f088832ba5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A3417050>]}
[0m22:02:35.793109 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 0.03s]
[0m22:02:35.794113 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:02:35.794113 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:02:35.795117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:35.795117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:35.796116 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:02:35.796116 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:02:35.796116 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m22:02:35.796116 [info ] [MainThread]: 
[0m22:02:35.796116 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m22:02:35.797118 [debug] [MainThread]: Command end result
[0m22:02:35.814625 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:02:35.815627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:02:35.818624 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:02:35.818624 [info ] [MainThread]: 
[0m22:02:35.819626 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:35.819626 [info ] [MainThread]: 
[0m22:02:35.819626 [error] [MainThread]:   Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:02:35.820624 [info ] [MainThread]: 
[0m22:02:35.820624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:02:35.820624 [debug] [MainThread]: Command `dbt run` failed at 22:02:35.820624 after 2.75 seconds
[0m22:02:35.821625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014090B58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A30A2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140A28F9400>]}
[0m22:02:35.821625 [debug] [MainThread]: Flushing usage events
[0m22:02:35.945233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:08.914071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248237A2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024820FC8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248214F1AF0>]}


============================== 22:03:08.916071 | e86f5fad-6668-4029-9064-1416cdce4d45 ==============================
[0m22:03:08.916071 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:03:08.917070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'send_anonymous_usage_stats': 'True'}
[0m22:03:09.486585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024835B10980>]}
[0m22:03:09.515093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002482116EE40>]}
[0m22:03:09.515093 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:03:09.705113 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:03:09.830621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:09.830621 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m22:03:09.997578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024836832AE0>]}
[0m22:03:10.045578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:03:10.047578 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:03:10.062643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248367C7620>]}
[0m22:03:10.063644 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m22:03:10.063644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002483682B500>]}
[0m22:03:10.064641 [info ] [MainThread]: 
[0m22:03:10.064641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:10.065641 [info ] [MainThread]: 
[0m22:03:10.066647 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:10.066647 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:03:10.066647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:11.081130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:03:11.081130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:11.301525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248360A7BC0>]}
[0m22:03:11.302527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:11.304525 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:03:11.304525 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m22:03:11.305527 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m22:03:11.305527 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:03:11.316524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:11.318528 [debug] [Thread-1 (]: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:03:11.319530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86f5fad-6668-4029-9064-1416cdce4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002483658C4D0>]}
[0m22:03:11.319530 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 0.01s]
[0m22:03:11.320529 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:03:11.320529 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:03:11.322529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:11.322529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:11.322529 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:03:11.322529 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:03:11.322529 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m22:03:11.322529 [info ] [MainThread]: 
[0m22:03:11.323528 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m22:03:11.323528 [debug] [MainThread]: Command end result
[0m22:03:11.341528 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:03:11.342529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:03:11.345528 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:03:11.345528 [info ] [MainThread]: 
[0m22:03:11.346529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:03:11.346529 [info ] [MainThread]: 
[0m22:03:11.347529 [error] [MainThread]:   Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:03:11.347529 [info ] [MainThread]: 
[0m22:03:11.347529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:03:11.348528 [debug] [MainThread]: Command `dbt run` failed at 22:03:11.347529 after 2.52 seconds
[0m22:03:11.348528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024823B773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024823AA31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024823F775F0>]}
[0m22:03:11.348528 [debug] [MainThread]: Flushing usage events
[0m22:03:11.460638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:14.172369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AEA5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9E5A07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9E5A3410>]}


============================== 22:05:14.174358 | 6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f ==============================
[0m22:05:14.174358 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:05:14.175358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.734679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9E60F080>]}
[0m22:05:14.761679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABAF964950>]}
[0m22:05:14.762679 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:05:14.962708 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:05:15.089214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:15.089214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:15.116218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB1552180>]}
[0m22:05:15.194723 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:05:15.196723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:05:15.211698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB15D8DD0>]}
[0m22:05:15.211698 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 660 macros
[0m22:05:15.211698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB0BDAB40>]}
[0m22:05:15.212697 [info ] [MainThread]: 
[0m22:05:15.212697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:15.213697 [info ] [MainThread]: 
[0m22:05:15.213697 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:05:15.214697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:05:15.214697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:16.232331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:05:16.232331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:16.447851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB0C10C80>]}
[0m22:05:16.447851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:16.449849 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:05:16.450848 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m22:05:16.450848 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m22:05:16.450848 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:05:16.463849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:16.465848 [debug] [Thread-1 (]: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:05:16.466851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6ef3ac-9454-49e7-bcbf-c77ac5f2e23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9E5DC800>]}
[0m22:05:16.466851 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__balance_sheet . [[31mERROR[0m in 0.02s]
[0m22:05:16.467849 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:05:16.467849 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__balance_sheet' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:05:16.468848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:16.468848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:16.468848 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:05:16.468848 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:05:16.468848 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m22:05:16.469849 [info ] [MainThread]: 
[0m22:05:16.469849 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m22:05:16.469849 [debug] [MainThread]: Command end result
[0m22:05:16.488847 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:05:16.489848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:05:16.492847 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:05:16.492847 [info ] [MainThread]: 
[0m22:05:16.492847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:16.493847 [info ] [MainThread]: 
[0m22:05:16.493847 [error] [MainThread]:   Compilation Error in model stg_fmp__balance_sheet (models\staging\fmp\stg_fmp__balance_sheet.sql)
  'to_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:05:16.493847 [info ] [MainThread]: 
[0m22:05:16.494847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:05:16.494847 [debug] [MainThread]: Command `dbt run` failed at 22:05:16.494847 after 2.41 seconds
[0m22:05:16.495847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AEA5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9EBED370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9EBEC200>]}
[0m22:05:16.495847 [debug] [MainThread]: Flushing usage events
[0m22:05:16.693465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:07:51.634915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAC915B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAA8E8D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAAED2810>]}


============================== 22:07:51.636909 | 6116238b-abe4-42c0-bc6e-f1507ba71a07 ==============================
[0m22:07:51.636909 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:07:51.637902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s int_fmp__balance_sheet', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:52.204381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBE4A24B0>]}
[0m22:07:52.232378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAD171070>]}
[0m22:07:52.232378 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:07:52.420402 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:07:52.552913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:07:52.552913 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://macros\safe_to_int.sql
[0m22:07:52.552913 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__balance_sheet.sql
[0m22:07:52.717963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC0214DD0>]}
[0m22:07:52.766962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:07:52.768964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:07:52.783486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC0156870>]}
[0m22:07:52.784488 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 661 macros
[0m22:07:52.784488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBFFC3CE0>]}
[0m22:07:52.785485 [info ] [MainThread]: 
[0m22:07:52.785485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:07:52.785485 [info ] [MainThread]: 
[0m22:07:52.786485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:07:52.786485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:07:52.786485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:53.797283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:07:53.798280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:53.970473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBFB6C920>]}
[0m22:07:53.970473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:53.973474 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:07:53.973474 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__balance_sheet .......... [RUN]
[0m22:07:53.973474 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__balance_sheet'
[0m22:07:53.973474 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:07:53.984477 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m22:07:53.988979 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m22:07:53.988979 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:07:54.023984 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    
SAFE_CAST(CAST(SAFE_CAST(cashAndCashEquivalents AS FLOAT64) AS INT64) AS INT64)
 AS CashAndCashEquivalents,
    
SAFE_CAST(CAST(SAFE_CAST(shortTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS ShortTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(cashAndShortTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS CashAndShortTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(netReceivables AS FLOAT64) AS INT64) AS INT64)
 AS NetReceivables,
    
SAFE_CAST(CAST(SAFE_CAST(inventory AS FLOAT64) AS INT64) AS INT64)
 AS Inventory,
    
SAFE_CAST(CAST(SAFE_CAST(otherCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalCurrentAssets,

    
SAFE_CAST(CAST(SAFE_CAST(propertyPlantEquipmentNet AS FLOAT64) AS INT64) AS INT64)
 AS PPENet,
    
SAFE_CAST(CAST(SAFE_CAST(goodwill AS FLOAT64) AS INT64) AS INT64)
 AS Goodwill,
    
SAFE_CAST(CAST(SAFE_CAST(intangibleAssets AS FLOAT64) AS INT64) AS INT64)
 AS IntangibleAssets,
    
SAFE_CAST(CAST(SAFE_CAST(goodwillAndIntangibleAssets AS FLOAT64) AS INT64) AS INT64)
 AS GoodwillAndIntangibleAssets,
    
SAFE_CAST(CAST(SAFE_CAST(longTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS LongTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(taxAssets AS FLOAT64) AS INT64) AS INT64)
 AS TaxAssets,
    
SAFE_CAST(CAST(SAFE_CAST(otherNonCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherNonCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalNonCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalNonCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(otherAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherAssets,

    
SAFE_CAST(CAST(SAFE_CAST(accountPayables AS FLOAT64) AS INT64) AS INT64)
 AS AccountPayables,
    
SAFE_CAST(CAST(SAFE_CAST(shortTermDebt AS FLOAT64) AS INT64) AS INT64)
 AS ShortTermDebt,
    
SAFE_CAST(CAST(SAFE_CAST(taxPayables AS FLOAT64) AS INT64) AS INT64)
 AS TaxPayables,
    
SAFE_CAST(CAST(SAFE_CAST(deferredRevenue AS FLOAT64) AS INT64) AS INT64)
 AS DeferredRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(otherCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(totalCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(longTermDebt AS FLOAT64) AS INT64) AS INT64)
 AS LongTermDebt,
    
SAFE_CAST(CAST(SAFE_CAST(deferredRevenueNonCurrent AS FLOAT64) AS INT64) AS INT64)
 AS DeferredRevenueNonCurrent,
    
SAFE_CAST(CAST(SAFE_CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64) AS INT64) AS INT64)

                                                AS DeferredTaxLiabilitiesNonCurrent,
    
SAFE_CAST(CAST(SAFE_CAST(otherNonCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherNonCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(totalNonCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalNonCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(otherLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(capitalLeaseObligations AS FLOAT64) AS INT64) AS INT64)
 AS CapitalLeaseObligations,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilities,

    
SAFE_CAST(CAST(SAFE_CAST(preferredStock AS FLOAT64) AS INT64) AS INT64)
 AS PreferredStock,
    
SAFE_CAST(CAST(SAFE_CAST(commonStock AS FLOAT64) AS INT64) AS INT64)
 AS CommonStock,
    
SAFE_CAST(CAST(SAFE_CAST(retainedEarnings AS FLOAT64) AS INT64) AS INT64)
 AS RetainedEarnings,
    
SAFE_CAST(CAST(SAFE_CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64) AS INT64) AS INT64)

                                                AS AOCI,
    
SAFE_CAST(CAST(SAFE_CAST(othertotalStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS OtherSHEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalStockholdersEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalEquity,

    
SAFE_CAST(CAST(SAFE_CAST(totalAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilitiesAndStockholdersEquity,
    
SAFE_CAST(CAST(SAFE_CAST(minorityInterest AS FLOAT64) AS INT64) AS INT64)
 AS MinorityInterest,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilitiesAndTotalEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilitiesAndTotalEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalInvestments AS FLOAT64) AS INT64) AS INT64)
 AS TotalInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(totalDebt AS FLOAT64) AS INT64) AS INT64)
 AS TotalDebt,
    
SAFE_CAST(CAST(SAFE_CAST(netDebt AS FLOAT64) AS INT64) AS INT64)
 AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:07:54.024984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:07:54.568903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:c74bdba9-7c2e-402a-8047-b2e0370a4438&page=queryresults
[0m22:07:54.732016 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as INT64)
 as CashAndCashEquivalents, 
      
    cast(null as INT64)
 as ShortTermInvestments, 
      
    cast(null as INT64)
 as CashAndShortTermInvestments, 
      
    cast(null as INT64)
 as NetReceivables, 
      
    cast(null as INT64)
 as Inventory, 
      
    cast(null as INT64)
 as OtherCurrentAssets, 
      
    cast(null as INT64)
 as TotalCurrentAssets, 
      
    cast(null as INT64)
 as PPENet, 
      
    cast(null as INT64)
 as Goodwill, 
      
    cast(null as INT64)
 as IntangibleAssets, 
      
    cast(null as INT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as INT64)
 as LongTermInvestments, 
      
    cast(null as INT64)
 as TaxAssets, 
      
    cast(null as INT64)
 as OtherNonCurrentAssets, 
      
    cast(null as INT64)
 as TotalNonCurrentAssets, 
      
    cast(null as INT64)
 as OtherAssets, 
      
    cast(null as INT64)
 as TotalAssets, 
      
    cast(null as INT64)
 as AccountPayables, 
      
    cast(null as INT64)
 as ShortTermDebt, 
      
    cast(null as INT64)
 as TaxPayables, 
      
    cast(null as INT64)
 as DeferredRevenue, 
      
    cast(null as INT64)
 as OtherCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalCurrentLiabilities, 
      
    cast(null as INT64)
 as LongTermDebt, 
      
    cast(null as INT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as INT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as INT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as INT64)
 as OtherLiabilities, 
      
    cast(null as INT64)
 as CapitalLeaseObligations, 
      
    cast(null as INT64)
 as TotalLiabilities, 
      
    cast(null as INT64)
 as PreferredStock, 
      
    cast(null as INT64)
 as CommonStock, 
      
    cast(null as INT64)
 as RetainedEarnings, 
      
    cast(null as INT64)
 as AOCI, 
      
    cast(null as INT64)
 as OtherSHEquity, 
      
    cast(null as INT64)
 as TotalStockholdersEquity, 
      
    cast(null as INT64)
 as TotalEquity, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as INT64)
 as MinorityInterest, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as INT64)
 as TotalInvestments, 
      
    cast(null as INT64)
 as TotalDebt, 
      
    cast(null as INT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:07:55.171419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:683064a3-12bd-41bf-9b26-94dce8d3102a&page=queryresults
[0m22:07:55.381640 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:07:55.390146 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__balance_sheet"
[0m22:07:55.391150 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    CashAndCashEquivalents INT64,
    ShortTermInvestments INT64,
    CashAndShortTermInvestments INT64,
    NetReceivables INT64,
    Inventory INT64,
    OtherCurrentAssets INT64,
    TotalCurrentAssets INT64,
    PPENet INT64,
    Goodwill INT64,
    IntangibleAssets INT64,
    GoodwillAndIntangibleAssets INT64,
    LongTermInvestments INT64,
    TaxAssets INT64,
    OtherNonCurrentAssets INT64,
    TotalNonCurrentAssets INT64,
    OtherAssets INT64,
    TotalAssets INT64,
    AccountPayables INT64,
    ShortTermDebt INT64,
    TaxPayables INT64,
    DeferredRevenue INT64,
    OtherCurrentLiabilities INT64,
    TotalCurrentLiabilities INT64,
    LongTermDebt INT64,
    DeferredRevenueNonCurrent INT64,
    DeferredTaxLiabilitiesNonCurrent INT64,
    OtherNonCurrentLiabilities INT64,
    TotalNonCurrentLiabilities INT64,
    OtherLiabilities INT64,
    CapitalLeaseObligations INT64,
    TotalLiabilities INT64,
    PreferredStock INT64,
    CommonStock INT64,
    RetainedEarnings INT64,
    AOCI INT64,
    OtherSHEquity INT64,
    TotalStockholdersEquity INT64,
    TotalEquity INT64,
    TotalLiabilitiesAndStockholdersEquity INT64,
    MinorityInterest INT64,
    TotalLiabilitiesAndTotalEquity INT64,
    TotalInvestments INT64,
    TotalDebt INT64,
    NetDebt INT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__balance_sheet as (


WITH source_data AS (

    SELECT
        *,
        _FILE_NAME           AS source_gcs_file_path  
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__balance_sheet_ext`

)

SELECT
    CAST(symbol                AS STRING)   AS Ticker,
    CAST(reportedCurrency      AS STRING)   AS ReportedCurrency,
    CAST(cik                   AS INT64)    AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)            AS ReportDate,       
    PARSE_DATE('%Y-%m-%d', fillingDate)     AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                            AS AcceptedDate,

    CAST(calendarYear          AS INT64)    AS CalendarYear,
    CAST(`period`                AS STRING)   AS Period,         

    
SAFE_CAST(CAST(SAFE_CAST(cashAndCashEquivalents AS FLOAT64) AS INT64) AS INT64)
 AS CashAndCashEquivalents,
    
SAFE_CAST(CAST(SAFE_CAST(shortTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS ShortTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(cashAndShortTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS CashAndShortTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(netReceivables AS FLOAT64) AS INT64) AS INT64)
 AS NetReceivables,
    
SAFE_CAST(CAST(SAFE_CAST(inventory AS FLOAT64) AS INT64) AS INT64)
 AS Inventory,
    
SAFE_CAST(CAST(SAFE_CAST(otherCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalCurrentAssets,

    
SAFE_CAST(CAST(SAFE_CAST(propertyPlantEquipmentNet AS FLOAT64) AS INT64) AS INT64)
 AS PPENet,
    
SAFE_CAST(CAST(SAFE_CAST(goodwill AS FLOAT64) AS INT64) AS INT64)
 AS Goodwill,
    
SAFE_CAST(CAST(SAFE_CAST(intangibleAssets AS FLOAT64) AS INT64) AS INT64)
 AS IntangibleAssets,
    
SAFE_CAST(CAST(SAFE_CAST(goodwillAndIntangibleAssets AS FLOAT64) AS INT64) AS INT64)
 AS GoodwillAndIntangibleAssets,
    
SAFE_CAST(CAST(SAFE_CAST(longTermInvestments AS FLOAT64) AS INT64) AS INT64)
 AS LongTermInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(taxAssets AS FLOAT64) AS INT64) AS INT64)
 AS TaxAssets,
    
SAFE_CAST(CAST(SAFE_CAST(otherNonCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherNonCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalNonCurrentAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalNonCurrentAssets,
    
SAFE_CAST(CAST(SAFE_CAST(otherAssets AS FLOAT64) AS INT64) AS INT64)
 AS OtherAssets,

    
SAFE_CAST(CAST(SAFE_CAST(accountPayables AS FLOAT64) AS INT64) AS INT64)
 AS AccountPayables,
    
SAFE_CAST(CAST(SAFE_CAST(shortTermDebt AS FLOAT64) AS INT64) AS INT64)
 AS ShortTermDebt,
    
SAFE_CAST(CAST(SAFE_CAST(taxPayables AS FLOAT64) AS INT64) AS INT64)
 AS TaxPayables,
    
SAFE_CAST(CAST(SAFE_CAST(deferredRevenue AS FLOAT64) AS INT64) AS INT64)
 AS DeferredRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(otherCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(totalCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(longTermDebt AS FLOAT64) AS INT64) AS INT64)
 AS LongTermDebt,
    
SAFE_CAST(CAST(SAFE_CAST(deferredRevenueNonCurrent AS FLOAT64) AS INT64) AS INT64)
 AS DeferredRevenueNonCurrent,
    
SAFE_CAST(CAST(SAFE_CAST(deferredTaxLiabilitiesNonCurrent AS FLOAT64) AS INT64) AS INT64)

                                                AS DeferredTaxLiabilitiesNonCurrent,
    
SAFE_CAST(CAST(SAFE_CAST(otherNonCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherNonCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(totalNonCurrentLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalNonCurrentLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(otherLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS OtherLiabilities,
    
SAFE_CAST(CAST(SAFE_CAST(capitalLeaseObligations AS FLOAT64) AS INT64) AS INT64)
 AS CapitalLeaseObligations,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilities AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilities,

    
SAFE_CAST(CAST(SAFE_CAST(preferredStock AS FLOAT64) AS INT64) AS INT64)
 AS PreferredStock,
    
SAFE_CAST(CAST(SAFE_CAST(commonStock AS FLOAT64) AS INT64) AS INT64)
 AS CommonStock,
    
SAFE_CAST(CAST(SAFE_CAST(retainedEarnings AS FLOAT64) AS INT64) AS INT64)
 AS RetainedEarnings,
    
SAFE_CAST(CAST(SAFE_CAST(accumulatedOtherComprehensiveIncomeLoss AS FLOAT64) AS INT64) AS INT64)

                                                AS AOCI,
    
SAFE_CAST(CAST(SAFE_CAST(othertotalStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS OtherSHEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalStockholdersEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalEquity,

    
SAFE_CAST(CAST(SAFE_CAST(totalAssets AS FLOAT64) AS INT64) AS INT64)
 AS TotalAssets,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilitiesAndStockholdersEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilitiesAndStockholdersEquity,
    
SAFE_CAST(CAST(SAFE_CAST(minorityInterest AS FLOAT64) AS INT64) AS INT64)
 AS MinorityInterest,
    
SAFE_CAST(CAST(SAFE_CAST(totalLiabilitiesAndTotalEquity AS FLOAT64) AS INT64) AS INT64)
 AS TotalLiabilitiesAndTotalEquity,
    
SAFE_CAST(CAST(SAFE_CAST(totalInvestments AS FLOAT64) AS INT64) AS INT64)
 AS TotalInvestments,
    
SAFE_CAST(CAST(SAFE_CAST(totalDebt AS FLOAT64) AS INT64) AS INT64)
 AS TotalDebt,
    
SAFE_CAST(CAST(SAFE_CAST(netDebt AS FLOAT64) AS INT64) AS INT64)
 AS NetDebt,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), balance_sheet AS (

    SELECT *
    FROM __dbt__cte__stg_fmp__balance_sheet

)

SELECT
    -- identifiers & dates
    Ticker,
    ReportDate,                    -- DATE
    `Period`,                        -- FY / Q1 / Q2 â€¦
    CalendarYear,                  -- INT64

    -- assets
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    -- liabilities
    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    -- equity
    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    -- totals
    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- links & metadata
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging

FROM balance_sheet


    ) as model_subq
    );
  
[0m22:07:55.720764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:733c54cc-79b7-4821-ab74-f278f0756126&page=queryresults
[0m22:07:57.802716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6116238b-abe4-42c0-bc6e-f1507ba71a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBFA65F10>]}
[0m22:07:57.802716 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model pco_dataset.int_fmp__balance_sheet ..... [[32mCREATE TABLE (2.2k rows, 1.3 MiB processed)[0m in 3.83s]
[0m22:07:57.803716 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__balance_sheet
[0m22:07:57.804716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:57.805717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:57.805717 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:07:57.805717 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:07:57.805717 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__balance_sheet' was properly closed.
[0m22:07:57.805717 [info ] [MainThread]: 
[0m22:07:57.805717 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m22:07:57.806717 [debug] [MainThread]: Command end result
[0m22:07:57.825717 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:07:57.827715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:07:57.830717 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:07:57.830717 [info ] [MainThread]: 
[0m22:07:57.830717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:57.831717 [info ] [MainThread]: 
[0m22:07:57.831717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:07:57.832719 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:57.832719 after 6.29 seconds
[0m22:07:57.832719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAC915B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAE989910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAD987A70>]}
[0m22:07:57.832719 [debug] [MainThread]: Flushing usage events
[0m22:07:57.949363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:02.714178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C0E1FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C13EBC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C0E1C1A0>]}


============================== 22:08:02.717171 | f7a84312-5af3-4365-9a1e-aa01e74a3785 ==============================
[0m22:08:02.717171 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:08:02.717171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s fct__balance_sheet', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:03.296794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D1C1D640>]}
[0m22:08:03.324830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D2A23740>]}
[0m22:08:03.324830 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:08:03.525097 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:08:03.652132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:03.652132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:03.680132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C1ECB080>]}
[0m22:08:03.760181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:08:03.762183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:08:03.778191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D4410110>]}
[0m22:08:03.778191 [info ] [MainThread]: Found 23 models, 2 seeds, 4 data tests, 10 sources, 661 macros
[0m22:08:03.779194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D43926F0>]}
[0m22:08:03.780194 [info ] [MainThread]: 
[0m22:08:03.780194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:03.780194 [info ] [MainThread]: 
[0m22:08:03.780194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:08:03.781192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:08:03.781192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:04.777933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:08:04.777933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:04.972385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D43DA6F0>]}
[0m22:08:04.972385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:04.974385 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__balance_sheet
[0m22:08:04.975384 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__balance_sheet .................... [RUN]
[0m22:08:04.975384 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__balance_sheet'
[0m22:08:04.976384 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__balance_sheet
[0m22:08:04.981385 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m22:08:04.982385 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__balance_sheet
[0m22:08:05.002893 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, `Period`
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:08:05.003894 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:05.424410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:abc7d6d3-fcdd-4ada-a783-875a3e5242bd&page=queryresults
[0m22:08:05.572049 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: select * from (
        select
    
      
    cast(null as STRING)
 as TickerDimKey, 
      
    cast(null as INT64)
 as DateDimKey, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as INT64)
 as RecencyRank, 
      
    cast(null as INT64)
 as CashAndCashEquivalents, 
      
    cast(null as INT64)
 as ShortTermInvestments, 
      
    cast(null as INT64)
 as CashAndShortTermInvestments, 
      
    cast(null as INT64)
 as NetReceivables, 
      
    cast(null as INT64)
 as Inventory, 
      
    cast(null as INT64)
 as OtherCurrentAssets, 
      
    cast(null as INT64)
 as TotalCurrentAssets, 
      
    cast(null as INT64)
 as PPENet, 
      
    cast(null as INT64)
 as Goodwill, 
      
    cast(null as INT64)
 as IntangibleAssets, 
      
    cast(null as INT64)
 as GoodwillAndIntangibleAssets, 
      
    cast(null as INT64)
 as LongTermInvestments, 
      
    cast(null as INT64)
 as TaxAssets, 
      
    cast(null as INT64)
 as OtherNonCurrentAssets, 
      
    cast(null as INT64)
 as TotalNonCurrentAssets, 
      
    cast(null as INT64)
 as OtherAssets, 
      
    cast(null as INT64)
 as TotalAssets, 
      
    cast(null as INT64)
 as AccountPayables, 
      
    cast(null as INT64)
 as ShortTermDebt, 
      
    cast(null as INT64)
 as TaxPayables, 
      
    cast(null as INT64)
 as DeferredRevenue, 
      
    cast(null as INT64)
 as OtherCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalCurrentLiabilities, 
      
    cast(null as INT64)
 as LongTermDebt, 
      
    cast(null as INT64)
 as DeferredRevenueNonCurrent, 
      
    cast(null as INT64)
 as DeferredTaxLiabilitiesNonCurrent, 
      
    cast(null as INT64)
 as OtherNonCurrentLiabilities, 
      
    cast(null as INT64)
 as TotalNonCurrentLiabilities, 
      
    cast(null as INT64)
 as OtherLiabilities, 
      
    cast(null as INT64)
 as CapitalLeaseObligations, 
      
    cast(null as INT64)
 as TotalLiabilities, 
      
    cast(null as INT64)
 as PreferredStock, 
      
    cast(null as INT64)
 as CommonStock, 
      
    cast(null as INT64)
 as RetainedEarnings, 
      
    cast(null as INT64)
 as AOCI, 
      
    cast(null as INT64)
 as OtherSHEquity, 
      
    cast(null as INT64)
 as TotalStockholdersEquity, 
      
    cast(null as INT64)
 as TotalEquity, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndStockholdersEquity, 
      
    cast(null as INT64)
 as MinorityInterest, 
      
    cast(null as INT64)
 as TotalLiabilitiesAndTotalEquity, 
      
    cast(null as INT64)
 as TotalInvestments, 
      
    cast(null as INT64)
 as TotalDebt, 
      
    cast(null as INT64)
 as NetDebt, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging, 
      
    cast(null as STRING)
 as DataSource
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:08:06.015446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:9bb6bcfb-eda5-42f1-b381-d6ba4b6d3f75&page=queryresults
[0m22:08:06.198961 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:08:06.199961 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:08:06.203463 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:08:06.211466 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.fct__balance_sheet"
[0m22:08:06.211466 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__balance_sheet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.fct__balance_sheet"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`fct__balance_sheet`
        
  (
    TickerDimKey STRING not null references `public-company-overview`.`pco_dataset`.`dim__tickers` (TickerDimKey) not enforced,
    DateDimKey INT64 not null references `public-company-overview`.`pco_dataset`.`dim__date` (DateDimKey) not enforced,
    Period STRING not null,
    CalendarYear INT64,
    RecencyRank INT64,
    CashAndCashEquivalents INT64,
    ShortTermInvestments INT64,
    CashAndShortTermInvestments INT64,
    NetReceivables INT64,
    Inventory INT64,
    OtherCurrentAssets INT64,
    TotalCurrentAssets INT64,
    PPENet INT64,
    Goodwill INT64,
    IntangibleAssets INT64,
    GoodwillAndIntangibleAssets INT64,
    LongTermInvestments INT64,
    TaxAssets INT64,
    OtherNonCurrentAssets INT64,
    TotalNonCurrentAssets INT64,
    OtherAssets INT64,
    TotalAssets INT64,
    AccountPayables INT64,
    ShortTermDebt INT64,
    TaxPayables INT64,
    DeferredRevenue INT64,
    OtherCurrentLiabilities INT64,
    TotalCurrentLiabilities INT64,
    LongTermDebt INT64,
    DeferredRevenueNonCurrent INT64,
    DeferredTaxLiabilitiesNonCurrent INT64,
    OtherNonCurrentLiabilities INT64,
    TotalNonCurrentLiabilities INT64,
    OtherLiabilities INT64,
    CapitalLeaseObligations INT64,
    TotalLiabilities INT64,
    PreferredStock INT64,
    CommonStock INT64,
    RetainedEarnings INT64,
    AOCI INT64,
    OtherSHEquity INT64,
    TotalStockholdersEquity INT64,
    TotalEquity INT64,
    TotalLiabilitiesAndStockholdersEquity INT64,
    MinorityInterest INT64,
    TotalLiabilitiesAndTotalEquity INT64,
    TotalInvestments INT64,
    TotalDebt INT64,
    NetDebt INT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    DataSource STRING,
    
    primary key (TickerDimKey, DateDimKey, Period, RecencyRank) not enforced
    )

      
    
    cluster by TickerDimKey, DateDimKey

    OPTIONS()
    as (
      
    select TickerDimKey, DateDimKey, Period, CalendarYear, RecencyRank, CashAndCashEquivalents, ShortTermInvestments, CashAndShortTermInvestments, NetReceivables, Inventory, OtherCurrentAssets, TotalCurrentAssets, PPENet, Goodwill, IntangibleAssets, GoodwillAndIntangibleAssets, LongTermInvestments, TaxAssets, OtherNonCurrentAssets, TotalNonCurrentAssets, OtherAssets, TotalAssets, AccountPayables, ShortTermDebt, TaxPayables, DeferredRevenue, OtherCurrentLiabilities, TotalCurrentLiabilities, LongTermDebt, DeferredRevenueNonCurrent, DeferredTaxLiabilitiesNonCurrent, OtherNonCurrentLiabilities, TotalNonCurrentLiabilities, OtherLiabilities, CapitalLeaseObligations, TotalLiabilities, PreferredStock, CommonStock, RetainedEarnings, AOCI, OtherSHEquity, TotalStockholdersEquity, TotalEquity, TotalLiabilitiesAndStockholdersEquity, MinorityInterest, TotalLiabilitiesAndTotalEquity, TotalInvestments, TotalDebt, NetDebt, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging, DataSource
    from (
        

WITH source_fmp AS (
    SELECT
        *,
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__balance_sheet`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT
        DateDimKey,
        EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT
        TickerDimKey,
        Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources s
    LEFT JOIN dim_date d
      ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t
      ON s.Ticker = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, `Period`
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    -- grain columns
    TickerDimKey,
    DateDimKey,
    Period,
    CalendarYear,

    -- financial statement
    CashAndCashEquivalents,
    ShortTermInvestments,
    CashAndShortTermInvestments,
    NetReceivables,
    Inventory,
    OtherCurrentAssets,
    TotalCurrentAssets,
    PPENet,
    Goodwill,
    IntangibleAssets,
    GoodwillAndIntangibleAssets,
    LongTermInvestments,
    TaxAssets,
    OtherNonCurrentAssets,
    TotalNonCurrentAssets,
    OtherAssets,
    TotalAssets,

    AccountPayables,
    ShortTermDebt,
    TaxPayables,
    DeferredRevenue,
    OtherCurrentLiabilities,
    TotalCurrentLiabilities,
    LongTermDebt,
    DeferredRevenueNonCurrent,
    DeferredTaxLiabilitiesNonCurrent,
    OtherNonCurrentLiabilities,
    TotalNonCurrentLiabilities,
    OtherLiabilities,
    CapitalLeaseObligations,
    TotalLiabilities,

    PreferredStock,
    CommonStock,
    RetainedEarnings,
    AOCI,
    OtherSHEquity,
    TotalStockholdersEquity,
    TotalEquity,

    TotalLiabilitiesAndStockholdersEquity,
    MinorityInterest,
    TotalLiabilitiesAndTotalEquity,
    TotalInvestments,
    TotalDebt,
    NetDebt,

    -- lineage
    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as model_subq
    );
  
[0m22:08:06.539657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:baad9559-038b-4c8b-a699-bd947206f54c&page=queryresults
[0m22:08:08.603874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a84312-5af3-4365-9a1e-aa01e74a3785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D3FB24E0>]}
[0m22:08:08.604876 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pco_dataset.fct__balance_sheet ............... [[32mCREATE TABLE (1.6k rows, 3.4 MiB processed)[0m in 3.63s]
[0m22:08:08.604876 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__balance_sheet
[0m22:08:08.606002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:08.606002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:08.606002 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:08:08.606002 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:08:08.607007 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__balance_sheet' was properly closed.
[0m22:08:08.607007 [info ] [MainThread]: 
[0m22:08:08.607007 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m22:08:08.607007 [debug] [MainThread]: Command end result
[0m22:08:08.625510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:08:08.626511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:08:08.629510 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:08:08.629510 [info ] [MainThread]: 
[0m22:08:08.630511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:08.630511 [info ] [MainThread]: 
[0m22:08:08.630511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:08:08.631512 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:08.631512 after 6.01 seconds
[0m22:08:08.631512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D3B0FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C13BAA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C13BA360>]}
[0m22:08:08.631512 [debug] [MainThread]: Flushing usage events
[0m22:08:08.690609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:48.588853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515DF8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A518771610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A518ABC470>]}


============================== 22:37:48.591853 | d8c51cb6-eaf8-4402-889b-151ab9559315 ==============================
[0m22:37:48.591853 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:37:48.591853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation stage_external_sources', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:37:49.184901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c51cb6-eaf8-4402-889b-151ab9559315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A528FC9CA0>]}
[0m22:37:49.211901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8c51cb6-eaf8-4402-889b-151ab9559315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516037A40>]}
[0m22:37:49.211901 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:37:49.406276 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:37:49.541297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:37:49.541297 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\staging\fmp\stg_fmp__income_statement.sql
[0m22:37:49.542298 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\_stg_fmp_sources.yml
[0m22:37:49.706810 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\staging\fmp\_stg_fmp_sources.yml @ sources: {'name': 'stg_fmp__income_statement_ext', 'external': {'location': 'gs://dbt-testing/fmp/income_statement/*.csv', 'options': {'format': 'csv', 'skip_leading_rows': 1}}, 'columns': [{'name': 'date', 'data_type': 'STRING'}, {'name': 'symbol', 'data_type': 'STRING'}, {'name': 'reportedCurrency', 'data_type': 'STRING'}, {'name': 'cik', 'data_type': 'STRING'}, {'name': 'fillingDate', 'data_type': 'STRING'}, {'name': 'acceptedDate', 'data_type': 'STRING'}, {'name': 'calendarYear', 'data_type': 'STRING'}, {'name': 'period', 'data_type': 'STRING'}, {'name': 'revenue', 'data_type': 'STRING'}, {'name': 'costOfRevenue', 'data_type': 'STRING'}, {'name': 'grossProfit', 'data_type': 'STRING'}, {'name': 'grossProfitRatio', 'data_type': 'STRING'}, {'name': 'researchAndDevelopmentExpenses', 'data_type': 'STRING'}, {'name': 'generalAndAdministrativeExpenses', 'data_type': 'STRING'}, {'name': 'sellingAndMarketingExpenses', 'data_type': 'STRING'}, {'name': 'sellingGeneralAndAdministrativeExpenses', 'data_type': 'STRING'}, {'name': 'otherExpenses', 'data_type': 'STRING'}, {'name': 'operatingExpenses', 'data_type': 'STRING'}, {'name': 'costAndExpenses', 'data_type': 'STRING'}, {'name': 'interestIncome', 'data_type': 'STRING'}, {'name': 'interestExpense', 'data_type': 'STRING'}, {'name': 'depreciationAndAmortization', 'data_type': 'STRING'}, {'name': 'ebitda', 'data_type': 'STRING'}, {'name': 'ebitdaratio', 'data_type': 'STRING'}, {'name': 'operatingIncome', 'data_type': 'STRING'}, {'name': 'operatingIncomeRatio', 'data_type': 'STRING'}, {'name': 'totalOtherIncomeExpensesNet', 'data_type': 'STRING'}, {'name': 'incomeBeforeTax', 'data_type': 'STRING'}, {'name': 'incomeBeforeTaxRatio', 'data_type': 'STRING'}, {'name': 'incomeTaxExpense', 'data_type': 'STRING'}, {'name': 'netIncome', 'data_type': 'STRING'}, {'name': 'netIncomeRatio', 'data_type': 'STRING'}, {'name': 'eps', 'data_type': 'STRING'}, {'name': 'epsdiluted', 'data_type': 'STRING'}, {'name': 'weightedAverageShsOut', 'data_type': 'STRING'}, {'name': 'weightedAverageShsOutDil', 'data_type': 'STRING'}, {'name': 'link', 'data_type': 'STRING'}, {'name': 'finalLink', 'data_type': 'STRING'}]} - at path []: Additional properties are not allowed ('columns', 'external' were unexpected)
[0m22:37:49.707810 [debug] [MainThread]: Command `dbt run-operation` failed at 22:37:49.707810 after 1.21 seconds
[0m22:37:49.708812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A51631F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A518DCE2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A529463170>]}
[0m22:37:49.708812 [debug] [MainThread]: Flushing usage events
[0m22:37:49.899722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:02.034122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A92D8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5ABE0B9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5ABE08860>]}


============================== 22:39:02.037118 | 11f708ae-9f30-4e79-bb56-23d3a9af6a56 ==============================
[0m22:39:02.037118 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:39:02.037118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run-operation stage_external_sources', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:39:02.601248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f708ae-9f30-4e79-bb56-23d3a9af6a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BE2819A0>]}
[0m22:39:02.630760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f708ae-9f30-4e79-bb56-23d3a9af6a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AB81B770>]}
[0m22:39:02.630760 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:39:02.841779 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:39:02.975291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:39:02.975291 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\staging\fmp\stg_fmp__income_statement.sql
[0m22:39:02.976291 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\_stg_fmp_sources.yml
[0m22:39:03.281822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f708ae-9f30-4e79-bb56-23d3a9af6a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BEAF7440>]}
[0m22:39:03.331332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:39:03.333333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:39:03.348328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f708ae-9f30-4e79-bb56-23d3a9af6a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BE7D8DD0>]}
[0m22:39:03.348328 [info ] [MainThread]: Found 24 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:39:03.349328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f708ae-9f30-4e79-bb56-23d3a9af6a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BEBB09B0>]}
[0m22:39:03.349328 [debug] [MainThread]: Acquiring new bigquery connection 'macro_stage_external_sources'
[0m22:39:03.356328 [info ] [MainThread]: 1 of 11 START external source pco_dataset.stg_polygon__hist_ticker_interval
[0m22:39:03.360328 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:03.361330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:04.567364 [info ] [MainThread]: 1 of 11 SKIP
[0m22:39:04.912812 [info ] [MainThread]: 2 of 11 START external source pco_dataset.stg_polygon__exchanges_ext
[0m22:39:04.913817 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:05.067595 [info ] [MainThread]: 2 of 11 SKIP
[0m22:39:05.331930 [info ] [MainThread]: 3 of 11 START external source pco_dataset.stg_polygon__tickers_ext
[0m22:39:05.332937 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:05.438256 [info ] [MainThread]: 3 of 11 SKIP
[0m22:39:05.716148 [info ] [MainThread]: 4 of 11 START external source pco_dataset.stg_yfinance__hist_ticker_daily
[0m22:39:05.717148 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:05.808680 [info ] [MainThread]: 4 of 11 SKIP
[0m22:39:06.116814 [info ] [MainThread]: 5 of 11 START external source pco_dataset.stg_yfinance__hist_ticker_interval
[0m22:39:06.117869 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:06.238861 [info ] [MainThread]: 5 of 11 SKIP
[0m22:39:06.495278 [info ] [MainThread]: 6 of 11 START external source pco_dataset.stg_yfinance__hist_tickers_interval
[0m22:39:06.496275 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:06.598301 [info ] [MainThread]: 6 of 11 SKIP
[0m22:39:06.895873 [info ] [MainThread]: 7 of 11 START external source pco_dataset.stg_fmp__hist_ticker_daily
[0m22:39:06.896873 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:07.013673 [info ] [MainThread]: 7 of 11 SKIP
[0m22:39:07.378049 [info ] [MainThread]: 8 of 11 START external source pco_dataset.stg_fmp__tickers_ext
[0m22:39:07.379053 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:07.478153 [info ] [MainThread]: 8 of 11 SKIP
[0m22:39:07.765759 [info ] [MainThread]: 9 of 11 START external source pco_dataset.stg_fmp__exchanges_ext
[0m22:39:07.766763 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:07.867054 [info ] [MainThread]: 9 of 11 SKIP
[0m22:39:08.104369 [info ] [MainThread]: 10 of 11 START external source pco_dataset.stg_fmp__balance_sheet_ext
[0m22:39:08.104369 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:08.234393 [info ] [MainThread]: 10 of 11 SKIP
[0m22:39:08.498415 [info ] [MainThread]: 11 of 11 START external source pco_dataset.stg_fmp__income_statement_ext
[0m22:39:08.499416 [debug] [MainThread]: On "macro_stage_external_sources": cache miss for schema "public-company-overview.pco_dataset", this is inefficient
[0m22:39:08.579932 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

    
        select * from `public-company-overview`.INFORMATION_SCHEMA.SCHEMATA where schema_name = 'pco_dataset' limit 1
    
  
[0m22:39:09.191782 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:10151600-0445-462f-a40e-2489f688cddc&page=queryresults
[0m22:39:09.787044 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

    
        select * from `public-company-overview`.INFORMATION_SCHEMA.SCHEMATA where schema_name = 'pco_dataset' limit 1
    
  
[0m22:39:10.355311 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:47d04d44-a624-410e-8874-7293c21e859e&page=queryresults
[0m22:39:10.939584 [info ] [MainThread]: 11 of 11 (1) create schema if not exists `public-company-overview`.pco_dataset
[0m22:39:10.942584 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

                 create schema if not exists `public-company-overview`.pco_dataset
            
[0m22:39:11.158067 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:0a2f0fac-652d-4f8f-a2b2-ca1a409aa6a0&page=queryresults
[0m22:39:11.368764 [info ] [MainThread]: 11 of 11 (1) None (0 processed)
[0m22:39:11.369763 [info ] [MainThread]: 11 of 11 (2) create or replace external table `public-company-overview`.`pco_dataset`.`stg_fm...  
[0m22:39:11.369763 [debug] [MainThread]: On macro_stage_external_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "connection_name": "macro_stage_external_sources"} */

                 
    

    create or replace external table `public-company-overview`.`pco_dataset`.`stg_fmp__income_statement_ext`(
            
                date STRING,
                symbol STRING,
                reportedCurrency STRING,
                cik STRING,
                fillingDate STRING,
                acceptedDate STRING,
                calendarYear STRING,
                period STRING,
                revenue STRING,
                costOfRevenue STRING,
                grossProfit STRING,
                grossProfitRatio STRING,
                researchAndDevelopmentExpenses STRING,
                generalAndAdministrativeExpenses STRING,
                sellingAndMarketingExpenses STRING,
                sellingGeneralAndAdministrativeExpenses STRING,
                otherExpenses STRING,
                operatingExpenses STRING,
                costAndExpenses STRING,
                interestIncome STRING,
                interestExpense STRING,
                depreciationAndAmortization STRING,
                ebitda STRING,
                ebitdaratio STRING,
                operatingIncome STRING,
                operatingIncomeRatio STRING,
                totalOtherIncomeExpensesNet STRING,
                incomeBeforeTax STRING,
                incomeBeforeTaxRatio STRING,
                incomeTaxExpense STRING,
                netIncome STRING,
                netIncomeRatio STRING,
                eps STRING,
                epsdiluted STRING,
                weightedAverageShsOut STRING,
                weightedAverageShsOutDil STRING,
                link STRING,
                finalLink STRING)
        
        
        
        options (
            uris = ['gs://dbt-testing/fmp/income_statement/*.csv'], format = 'csv', skip_leading_rows = 1)


            
[0m22:39:11.532091 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:b62a3e96-a9e5-4311-ac8c-1ef291cd4ce5&page=queryresults
[0m22:39:12.070880 [info ] [MainThread]: 11 of 11 (2) None (0 processed)
[0m22:39:12.327560 [debug] [MainThread]: Wrote artifact RunResultsArtifact to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:39:12.328565 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:39:12.327560 after 10.39 seconds
[0m22:39:12.328565 [debug] [MainThread]: Connection 'macro_stage_external_sources' was properly closed.
[0m22:39:12.328565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AC285BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BE7832F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BEAC0170>]}
[0m22:39:12.328565 [debug] [MainThread]: Flushing usage events
[0m22:39:12.464291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:00.528490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275C52CB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022759C56F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022758F0A990>]}


============================== 22:40:00.530490 | 88300c43-19a5-4eb6-a5b5-3aa5a828b33a ==============================
[0m22:40:00.530490 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:40:00.531490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s int_fmp__income_statement', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:40:01.097266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88300c43-19a5-4eb6-a5b5-3aa5a828b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276E863D10>]}
[0m22:40:01.125266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88300c43-19a5-4eb6-a5b5-3aa5a828b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022759AA7B90>]}
[0m22:40:01.125266 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:40:01.318483 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:40:01.447528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:01.447528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:01.504039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88300c43-19a5-4eb6-a5b5-3aa5a828b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276EA74620>]}
[0m22:40:01.555039 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:40:01.557039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:40:01.571765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88300c43-19a5-4eb6-a5b5-3aa5a828b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276EEC1310>]}
[0m22:40:01.572764 [info ] [MainThread]: Found 24 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:40:01.572764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88300c43-19a5-4eb6-a5b5-3aa5a828b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276E5F20C0>]}
[0m22:40:01.572764 [warn ] [MainThread]: The selection criterion 'int_fmp__income_statement' does not match any enabled nodes
[0m22:40:01.573764 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:40:01.574764 [debug] [MainThread]: Command end result
[0m22:40:01.591764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:40:01.592765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:40:01.594766 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:40:01.594766 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:01.594766 after 1.16 seconds
[0m22:40:01.594766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275C52CB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275BD5BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275BD59100>]}
[0m22:40:01.595767 [debug] [MainThread]: Flushing usage events
[0m22:40:01.659525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:29.419963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F28FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F28FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F28ECC0>]}


============================== 22:42:29.422962 | 42bd1046-d14c-4aef-b5d7-124ed45e61bf ==============================
[0m22:42:29.422962 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:42:29.423964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s int_fmp__income_statement', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:30.028184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD023D4320>]}
[0m22:42:30.054690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02437710>]}
[0m22:42:30.054690 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:42:30.248708 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:42:30.382774 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m22:42:30.382774 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\intermediate\fmp\int_fmp__income_statement.sql
[0m22:42:30.383775 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\_int_fmp_models.yml
[0m22:42:30.383775 [debug] [MainThread]: Partial parsing: deleted file: public_company_overview_dbt://models\staging\fmp\stg_fmp__income_statement.sql
[0m22:42:30.543794 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for ephemeral
materializations and will be ignored.  Set 'warn_unsupported: false' on this
constraint to ignore this warning.
[0m22:42:30.585794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02CE9970>]}
[0m22:42:30.636306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:42:30.638309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:42:30.655832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0296A3C0>]}
[0m22:42:30.655832 [info ] [MainThread]: Found 24 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:42:30.656832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02CE9220>]}
[0m22:42:30.657836 [info ] [MainThread]: 
[0m22:42:30.657836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:30.657836 [info ] [MainThread]: 
[0m22:42:30.657836 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:42:30.660832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:42:30.660832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:31.815909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bd1046-d14c-4aef-b5d7-124ed45e61bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F6EB980>]}
[0m22:42:31.815909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:31.817909 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:42:31.818909 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__income_statement'
[0m22:42:31.818909 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:42:31.824913 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:42:31.825913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:42:31.825913 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:42:31.826913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:31.826913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:31.826913 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:42:31.826913 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__income_statement' was properly closed.
[0m22:42:31.826913 [info ] [MainThread]: 
[0m22:42:31.827913 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m22:42:31.827913 [debug] [MainThread]: Command end result
[0m22:42:31.845423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:42:31.847424 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:42:31.849422 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:42:31.849422 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:31.849422 after 2.54 seconds
[0m22:42:31.849422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F4DD2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F5CF140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02E566F0>]}
[0m22:42:31.850424 [debug] [MainThread]: Flushing usage events
[0m22:42:31.957427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:58.281597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D3A6C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D391ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D391F320>]}


============================== 22:44:58.283597 | e1b03f54-5d21-4952-839a-5d8640154d5d ==============================
[0m22:44:58.283597 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:44:58.284597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s int_fmp__income_statement', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:44:58.868714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D32EF7D0>]}
[0m22:44:58.897717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E5DFBD40>]}
[0m22:44:58.898717 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:44:59.091731 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:44:59.229748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:44:59.230748 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\staging\fmp\stg_fmp__income_statement.sql
[0m22:44:59.230748 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\int_fmp__income_statement.sql
[0m22:44:59.437768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E6712EA0>]}
[0m22:44:59.487767 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:44:59.490768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:44:59.507774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E62FDD00>]}
[0m22:44:59.507774 [info ] [MainThread]: Found 25 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:44:59.507774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E6636240>]}
[0m22:44:59.508774 [info ] [MainThread]: 
[0m22:44:59.508774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:59.509773 [info ] [MainThread]: 
[0m22:44:59.509773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:44:59.509773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:44:59.510773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:00.578033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:45:00.579032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:00.779999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E60775F0>]}
[0m22:45:00.779999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:00.781998 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:00.782998 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__income_statement ....... [RUN]
[0m22:45:00.782998 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__income_statement'
[0m22:45:00.783998 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:00.790998 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:00.793998 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:00.794998 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:00.829506 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: select * from (
        

WITH  __dbt__cte__stg_fmp__income_statement as (


WITH source_data AS (
    SELECT
        *,
        _FILE_NAME AS source_gcs_file_path
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__income_statement_ext`
)

SELECT
    CAST(symbol           AS STRING)             AS Ticker,
    CAST(reportedCurrency AS STRING)             AS ReportedCurrency,
    
SAFE_CAST(CAST(SAFE_CAST(cik AS FLOAT64) AS INT64) AS INT64)
                          AS CIK,

    PARSE_DATE('%m/%d/%Y', `date`)                 AS ReportDate,
    PARSE_DATE('%m/%d/%Y', fillingDate)          AS FilingDate,
    PARSE_DATETIME('%m/%d/%Y %H:%M', acceptedDate)
                                                AS AcceptedDate,

    
SAFE_CAST(CAST(SAFE_CAST(calendarYear AS FLOAT64) AS INT64) AS INT64)
                 AS CalendarYear,
    CAST(`period` AS STRING)                       AS Period,

    
SAFE_CAST(CAST(SAFE_CAST(revenue AS FLOAT64) AS INT64) AS INT64)
                      AS Revenue,
    
SAFE_CAST(CAST(SAFE_CAST(costOfRevenue AS FLOAT64) AS INT64) AS INT64)
                AS CostOfRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(grossProfit AS FLOAT64) AS INT64) AS INT64)
                  AS GrossProfit,
    SAFE_CAST(grossProfitRatio AS FLOAT64)       AS GrossProfitRatio,

    
SAFE_CAST(CAST(SAFE_CAST(researchAndDevelopmentExpenses AS FLOAT64) AS INT64) AS INT64)
        AS RnDExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(generalAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
      AS GAndAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingAndMarketingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS SellingAndMarketingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingGeneralAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
 AS SGnAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(otherExpenses AS FLOAT64) AS INT64) AS INT64)
               AS OtherExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(operatingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS OperatingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(costAndExpenses AS FLOAT64) AS INT64) AS INT64)
             AS CostAndExpenses,

    
SAFE_CAST(CAST(SAFE_CAST(interestIncome AS FLOAT64) AS INT64) AS INT64)
              AS InterestIncome,
    
SAFE_CAST(CAST(SAFE_CAST(interestExpense AS FLOAT64) AS INT64) AS INT64)
             AS InterestExpense,
    
SAFE_CAST(CAST(SAFE_CAST(depreciationAndAmortization AS FLOAT64) AS INT64) AS INT64)
 AS DepreciationAndAmortization,

    
SAFE_CAST(CAST(SAFE_CAST(ebitda AS FLOAT64) AS INT64) AS INT64)
                      AS EBITDA,
    SAFE_CAST(ebitdaratio AS FLOAT64)           AS EBITDARatio,
    
SAFE_CAST(CAST(SAFE_CAST(operatingIncome AS FLOAT64) AS INT64) AS INT64)
             AS OperatingIncome,
    SAFE_CAST(operatingIncomeRatio AS FLOAT64)  AS OperatingIncomeRatio,
    
SAFE_CAST(CAST(SAFE_CAST(totalOtherIncomeExpensesNet AS FLOAT64) AS INT64) AS INT64)
 AS TotalOtherIncomeExpensesNet,
    
SAFE_CAST(CAST(SAFE_CAST(incomeBeforeTax AS FLOAT64) AS INT64) AS INT64)
             AS IncomeBeforeTax,
    SAFE_CAST(incomeBeforeTaxRatio AS FLOAT64)  AS IncomeBeforeTaxRatio,
    
SAFE_CAST(CAST(SAFE_CAST(incomeTaxExpense AS FLOAT64) AS INT64) AS INT64)
            AS IncomeTaxExpense,
    
SAFE_CAST(CAST(SAFE_CAST(netIncome AS FLOAT64) AS INT64) AS INT64)
                   AS NetIncome,
    SAFE_CAST(netIncomeRatio AS FLOAT64)        AS NetIncomeRatio,

    SAFE_CAST(eps AS FLOAT64)                   AS EPS,
    SAFE_CAST(epsdiluted AS FLOAT64)            AS EPSDiluted,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOut AS FLOAT64) AS INT64) AS INT64)
       AS WeightedAverageShares,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOutDil AS FLOAT64) AS INT64) AS INT64)
    AS WeightedAverageSharesDiluted,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), stg AS (
    SELECT *
    FROM __dbt__cte__stg_fmp__income_statement 
)

SELECT
    Ticker,
    ReportDate,
    Period,
    CalendarYear,
    ReportedCurrency,
    CIK,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,

    FileTimestamp,
    DBTLoadedAtStaging

FROM stg


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:45:00.829506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:01.598475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:02340bfb-b6fc-4267-a9e7-5689802292c7&page=queryresults
[0m22:45:01.745494 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as STRING)
 as ReportedCurrency, 
      
    cast(null as INT64)
 as CIK, 
      
    cast(null as INT64)
 as Revenue, 
      
    cast(null as INT64)
 as CostOfRevenue, 
      
    cast(null as INT64)
 as GrossProfit, 
      
    cast(null as FLOAT64)
 as GrossProfitRatio, 
      
    cast(null as INT64)
 as RnDExpenses, 
      
    cast(null as INT64)
 as GAndAExpenses, 
      
    cast(null as INT64)
 as SellingAndMarketingExpenses, 
      
    cast(null as INT64)
 as SGnAExpenses, 
      
    cast(null as INT64)
 as OtherExpenses, 
      
    cast(null as INT64)
 as OperatingExpenses, 
      
    cast(null as INT64)
 as CostAndExpenses, 
      
    cast(null as INT64)
 as InterestIncome, 
      
    cast(null as INT64)
 as InterestExpense, 
      
    cast(null as INT64)
 as DepreciationAndAmortization, 
      
    cast(null as INT64)
 as EBITDA, 
      
    cast(null as FLOAT64)
 as EBITDARatio, 
      
    cast(null as INT64)
 as OperatingIncome, 
      
    cast(null as FLOAT64)
 as OperatingIncomeRatio, 
      
    cast(null as INT64)
 as TotalOtherIncomeExpensesNet, 
      
    cast(null as INT64)
 as IncomeBeforeTax, 
      
    cast(null as FLOAT64)
 as IncomeBeforeTaxRatio, 
      
    cast(null as INT64)
 as IncomeTaxExpense, 
      
    cast(null as INT64)
 as NetIncome, 
      
    cast(null as FLOAT64)
 as NetIncomeRatio, 
      
    cast(null as FLOAT64)
 as EPS, 
      
    cast(null as FLOAT64)
 as EPSDiluted, 
      
    cast(null as INT64)
 as WeightedAverageShares, 
      
    cast(null as INT64)
 as WeightedAverageSharesDiluted, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:45:02.209080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:2cfce5ba-b2e1-440a-b333-ddbbcbb2b915&page=queryresults
[0m22:45:02.449441 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:45:02.458441 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:02.459442 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__income_statement"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__income_statement`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    ReportedCurrency STRING,
    CIK INT64,
    Revenue INT64,
    CostOfRevenue INT64,
    GrossProfit INT64,
    GrossProfitRatio FLOAT64,
    RnDExpenses INT64,
    GAndAExpenses INT64,
    SellingAndMarketingExpenses INT64,
    SGnAExpenses INT64,
    OtherExpenses INT64,
    OperatingExpenses INT64,
    CostAndExpenses INT64,
    InterestIncome INT64,
    InterestExpense INT64,
    DepreciationAndAmortization INT64,
    EBITDA INT64,
    EBITDARatio FLOAT64,
    OperatingIncome INT64,
    OperatingIncomeRatio FLOAT64,
    TotalOtherIncomeExpensesNet INT64,
    IncomeBeforeTax INT64,
    IncomeBeforeTaxRatio FLOAT64,
    IncomeTaxExpense INT64,
    NetIncome INT64,
    NetIncomeRatio FLOAT64,
    EPS FLOAT64,
    EPSDiluted FLOAT64,
    WeightedAverageShares INT64,
    WeightedAverageSharesDiluted INT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, ReportedCurrency, CIK, Revenue, CostOfRevenue, GrossProfit, GrossProfitRatio, RnDExpenses, GAndAExpenses, SellingAndMarketingExpenses, SGnAExpenses, OtherExpenses, OperatingExpenses, CostAndExpenses, InterestIncome, InterestExpense, DepreciationAndAmortization, EBITDA, EBITDARatio, OperatingIncome, OperatingIncomeRatio, TotalOtherIncomeExpensesNet, IncomeBeforeTax, IncomeBeforeTaxRatio, IncomeTaxExpense, NetIncome, NetIncomeRatio, EPS, EPSDiluted, WeightedAverageShares, WeightedAverageSharesDiluted, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__income_statement as (


WITH source_data AS (
    SELECT
        *,
        _FILE_NAME AS source_gcs_file_path
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__income_statement_ext`
)

SELECT
    CAST(symbol           AS STRING)             AS Ticker,
    CAST(reportedCurrency AS STRING)             AS ReportedCurrency,
    
SAFE_CAST(CAST(SAFE_CAST(cik AS FLOAT64) AS INT64) AS INT64)
                          AS CIK,

    PARSE_DATE('%m/%d/%Y', `date`)                 AS ReportDate,
    PARSE_DATE('%m/%d/%Y', fillingDate)          AS FilingDate,
    PARSE_DATETIME('%m/%d/%Y %H:%M', acceptedDate)
                                                AS AcceptedDate,

    
SAFE_CAST(CAST(SAFE_CAST(calendarYear AS FLOAT64) AS INT64) AS INT64)
                 AS CalendarYear,
    CAST(`period` AS STRING)                       AS Period,

    
SAFE_CAST(CAST(SAFE_CAST(revenue AS FLOAT64) AS INT64) AS INT64)
                      AS Revenue,
    
SAFE_CAST(CAST(SAFE_CAST(costOfRevenue AS FLOAT64) AS INT64) AS INT64)
                AS CostOfRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(grossProfit AS FLOAT64) AS INT64) AS INT64)
                  AS GrossProfit,
    SAFE_CAST(grossProfitRatio AS FLOAT64)       AS GrossProfitRatio,

    
SAFE_CAST(CAST(SAFE_CAST(researchAndDevelopmentExpenses AS FLOAT64) AS INT64) AS INT64)
        AS RnDExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(generalAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
      AS GAndAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingAndMarketingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS SellingAndMarketingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingGeneralAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
 AS SGnAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(otherExpenses AS FLOAT64) AS INT64) AS INT64)
               AS OtherExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(operatingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS OperatingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(costAndExpenses AS FLOAT64) AS INT64) AS INT64)
             AS CostAndExpenses,

    
SAFE_CAST(CAST(SAFE_CAST(interestIncome AS FLOAT64) AS INT64) AS INT64)
              AS InterestIncome,
    
SAFE_CAST(CAST(SAFE_CAST(interestExpense AS FLOAT64) AS INT64) AS INT64)
             AS InterestExpense,
    
SAFE_CAST(CAST(SAFE_CAST(depreciationAndAmortization AS FLOAT64) AS INT64) AS INT64)
 AS DepreciationAndAmortization,

    
SAFE_CAST(CAST(SAFE_CAST(ebitda AS FLOAT64) AS INT64) AS INT64)
                      AS EBITDA,
    SAFE_CAST(ebitdaratio AS FLOAT64)           AS EBITDARatio,
    
SAFE_CAST(CAST(SAFE_CAST(operatingIncome AS FLOAT64) AS INT64) AS INT64)
             AS OperatingIncome,
    SAFE_CAST(operatingIncomeRatio AS FLOAT64)  AS OperatingIncomeRatio,
    
SAFE_CAST(CAST(SAFE_CAST(totalOtherIncomeExpensesNet AS FLOAT64) AS INT64) AS INT64)
 AS TotalOtherIncomeExpensesNet,
    
SAFE_CAST(CAST(SAFE_CAST(incomeBeforeTax AS FLOAT64) AS INT64) AS INT64)
             AS IncomeBeforeTax,
    SAFE_CAST(incomeBeforeTaxRatio AS FLOAT64)  AS IncomeBeforeTaxRatio,
    
SAFE_CAST(CAST(SAFE_CAST(incomeTaxExpense AS FLOAT64) AS INT64) AS INT64)
            AS IncomeTaxExpense,
    
SAFE_CAST(CAST(SAFE_CAST(netIncome AS FLOAT64) AS INT64) AS INT64)
                   AS NetIncome,
    SAFE_CAST(netIncomeRatio AS FLOAT64)        AS NetIncomeRatio,

    SAFE_CAST(eps AS FLOAT64)                   AS EPS,
    SAFE_CAST(epsdiluted AS FLOAT64)            AS EPSDiluted,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOut AS FLOAT64) AS INT64) AS INT64)
       AS WeightedAverageShares,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOutDil AS FLOAT64) AS INT64) AS INT64)
    AS WeightedAverageSharesDiluted,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), stg AS (
    SELECT *
    FROM __dbt__cte__stg_fmp__income_statement 
)

SELECT
    Ticker,
    ReportDate,
    Period,
    CalendarYear,
    ReportedCurrency,
    CIK,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,

    FileTimestamp,
    DBTLoadedAtStaging

FROM stg


    ) as model_subq
    );
  
[0m22:45:02.778152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:32043541-8cc8-46b3-888c-e2e2c156f1d5&page=queryresults
[0m22:45:03.225843 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:32043541-8cc8-46b3-888c-e2e2c156f1d5&page=queryresults
[0m22:45:03.229843 [debug] [Thread-1 (]: Database Error in model int_fmp__income_statement (models\intermediate\fmp\int_fmp__income_statement.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__income_statement.sql
[0m22:45:03.231843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b03f54-5d21-4952-839a-5d8640154d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E68B75F0>]}
[0m22:45:03.231843 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model pco_dataset.int_fmp__income_statement  [[31mERROR[0m in 2.45s]
[0m22:45:03.232843 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:03.232843 [debug] [Thread-4 (]: Marking all children of 'model.public_company_overview_dbt.int_fmp__income_statement' to be skipped because of status 'error'.  Reason: Database Error in model int_fmp__income_statement (models\intermediate\fmp\int_fmp__income_statement.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__income_statement.sql.
[0m22:45:03.233844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:03.233844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:03.234845 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:45:03.234845 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:45:03.234845 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__income_statement' was properly closed.
[0m22:45:03.234845 [info ] [MainThread]: 
[0m22:45:03.235844 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m22:45:03.235844 [debug] [MainThread]: Command end result
[0m22:45:03.255843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:45:03.256847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:45:03.260843 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:45:03.260843 [info ] [MainThread]: 
[0m22:45:03.260843 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:45:03.261845 [info ] [MainThread]: 
[0m22:45:03.261845 [error] [MainThread]:   Database Error in model int_fmp__income_statement (models\intermediate\fmp\int_fmp__income_statement.sql)
  Failed to parse input string "2024-12-31"
  compiled code at target\run\public_company_overview_dbt\models\intermediate\fmp\int_fmp__income_statement.sql
[0m22:45:03.262843 [info ] [MainThread]: 
[0m22:45:03.262843 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:45:03.262843 [debug] [MainThread]: Command `dbt run` failed at 22:45:03.262843 after 5.07 seconds
[0m22:45:03.262843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D3C32C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D3216000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D3215F70>]}
[0m22:45:03.263843 [debug] [MainThread]: Flushing usage events
[0m22:45:03.395793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:45:41.987941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2D6FD640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2DCEDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2B0785C0>]}


============================== 22:45:41.990941 | 5b5d0b37-2b5c-4932-b1e6-060182950334 ==============================
[0m22:45:41.990941 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:45:41.990941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s int_fmp__income_statement', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:45:42.559924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2DFD63F0>]}
[0m22:45:42.588437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4024FB90>]}
[0m22:45:42.588437 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:45:42.783462 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:45:42.922092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:45:42.922092 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\staging\fmp\stg_fmp__income_statement.sql
[0m22:45:42.922092 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\intermediate\fmp\int_fmp__income_statement.sql
[0m22:45:43.125644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC40876B40>]}
[0m22:45:43.175644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:45:43.177644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:45:43.193309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC40AAFDA0>]}
[0m22:45:43.193309 [info ] [MainThread]: Found 25 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:45:43.193309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3EB0B7A0>]}
[0m22:45:43.194309 [info ] [MainThread]: 
[0m22:45:43.195308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:45:43.195308 [info ] [MainThread]: 
[0m22:45:43.195308 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:45:43.196309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:45:43.196309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:44.181971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:45:44.181971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:44.361624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC40906C30>]}
[0m22:45:44.361624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:44.364264 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:44.364264 [info ] [Thread-1 (]: 1 of 1 START sql incremental model pco_dataset.int_fmp__income_statement ....... [RUN]
[0m22:45:44.365263 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.int_fmp__income_statement'
[0m22:45:44.365263 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:44.372263 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:44.375262 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:44.376263 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:44.411773 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: select * from (
        

WITH  __dbt__cte__stg_fmp__income_statement as (


WITH source_data AS (
    SELECT
        *,
        _FILE_NAME AS source_gcs_file_path
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__income_statement_ext`
)

SELECT
    CAST(symbol           AS STRING)             AS Ticker,
    CAST(reportedCurrency AS STRING)             AS ReportedCurrency,
    
SAFE_CAST(CAST(SAFE_CAST(cik AS FLOAT64) AS INT64) AS INT64)
                          AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)                 AS ReportDate,
    PARSE_DATE('%Y-%m-%d', fillingDate)          AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                                AS AcceptedDate,

    
SAFE_CAST(CAST(SAFE_CAST(calendarYear AS FLOAT64) AS INT64) AS INT64)
                 AS CalendarYear,
    CAST(`period` AS STRING)                       AS Period,

    
SAFE_CAST(CAST(SAFE_CAST(revenue AS FLOAT64) AS INT64) AS INT64)
                      AS Revenue,
    
SAFE_CAST(CAST(SAFE_CAST(costOfRevenue AS FLOAT64) AS INT64) AS INT64)
                AS CostOfRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(grossProfit AS FLOAT64) AS INT64) AS INT64)
                  AS GrossProfit,
    SAFE_CAST(grossProfitRatio AS FLOAT64)       AS GrossProfitRatio,

    
SAFE_CAST(CAST(SAFE_CAST(researchAndDevelopmentExpenses AS FLOAT64) AS INT64) AS INT64)
        AS RnDExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(generalAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
      AS GAndAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingAndMarketingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS SellingAndMarketingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingGeneralAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
 AS SGnAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(otherExpenses AS FLOAT64) AS INT64) AS INT64)
               AS OtherExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(operatingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS OperatingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(costAndExpenses AS FLOAT64) AS INT64) AS INT64)
             AS CostAndExpenses,

    
SAFE_CAST(CAST(SAFE_CAST(interestIncome AS FLOAT64) AS INT64) AS INT64)
              AS InterestIncome,
    
SAFE_CAST(CAST(SAFE_CAST(interestExpense AS FLOAT64) AS INT64) AS INT64)
             AS InterestExpense,
    
SAFE_CAST(CAST(SAFE_CAST(depreciationAndAmortization AS FLOAT64) AS INT64) AS INT64)
 AS DepreciationAndAmortization,

    
SAFE_CAST(CAST(SAFE_CAST(ebitda AS FLOAT64) AS INT64) AS INT64)
                      AS EBITDA,
    SAFE_CAST(ebitdaratio AS FLOAT64)           AS EBITDARatio,
    
SAFE_CAST(CAST(SAFE_CAST(operatingIncome AS FLOAT64) AS INT64) AS INT64)
             AS OperatingIncome,
    SAFE_CAST(operatingIncomeRatio AS FLOAT64)  AS OperatingIncomeRatio,
    
SAFE_CAST(CAST(SAFE_CAST(totalOtherIncomeExpensesNet AS FLOAT64) AS INT64) AS INT64)
 AS TotalOtherIncomeExpensesNet,
    
SAFE_CAST(CAST(SAFE_CAST(incomeBeforeTax AS FLOAT64) AS INT64) AS INT64)
             AS IncomeBeforeTax,
    SAFE_CAST(incomeBeforeTaxRatio AS FLOAT64)  AS IncomeBeforeTaxRatio,
    
SAFE_CAST(CAST(SAFE_CAST(incomeTaxExpense AS FLOAT64) AS INT64) AS INT64)
            AS IncomeTaxExpense,
    
SAFE_CAST(CAST(SAFE_CAST(netIncome AS FLOAT64) AS INT64) AS INT64)
                   AS NetIncome,
    SAFE_CAST(netIncomeRatio AS FLOAT64)        AS NetIncomeRatio,

    SAFE_CAST(eps AS FLOAT64)                   AS EPS,
    SAFE_CAST(epsdiluted AS FLOAT64)            AS EPSDiluted,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOut AS FLOAT64) AS INT64) AS INT64)
       AS WeightedAverageShares,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOutDil AS FLOAT64) AS INT64) AS INT64)
    AS WeightedAverageSharesDiluted,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), stg AS (
    SELECT *
    FROM __dbt__cte__stg_fmp__income_statement 
)

SELECT
    Ticker,
    ReportDate,
    `Period`,
    CalendarYear,
    ReportedCurrency,
    CIK,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,

    FileTimestamp,
    DBTLoadedAtStaging

FROM stg


    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:45:44.411773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:45.001066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:6d2cdebe-e1e7-4860-82d7-8dc656d04242&page=queryresults
[0m22:45:45.141138 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: select * from (
        select
    
      
    cast(null as STRING)
 as Ticker, 
      
    cast(null as DATE)
 as ReportDate, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as STRING)
 as ReportedCurrency, 
      
    cast(null as INT64)
 as CIK, 
      
    cast(null as INT64)
 as Revenue, 
      
    cast(null as INT64)
 as CostOfRevenue, 
      
    cast(null as INT64)
 as GrossProfit, 
      
    cast(null as FLOAT64)
 as GrossProfitRatio, 
      
    cast(null as INT64)
 as RnDExpenses, 
      
    cast(null as INT64)
 as GAndAExpenses, 
      
    cast(null as INT64)
 as SellingAndMarketingExpenses, 
      
    cast(null as INT64)
 as SGnAExpenses, 
      
    cast(null as INT64)
 as OtherExpenses, 
      
    cast(null as INT64)
 as OperatingExpenses, 
      
    cast(null as INT64)
 as CostAndExpenses, 
      
    cast(null as INT64)
 as InterestIncome, 
      
    cast(null as INT64)
 as InterestExpense, 
      
    cast(null as INT64)
 as DepreciationAndAmortization, 
      
    cast(null as INT64)
 as EBITDA, 
      
    cast(null as FLOAT64)
 as EBITDARatio, 
      
    cast(null as INT64)
 as OperatingIncome, 
      
    cast(null as FLOAT64)
 as OperatingIncomeRatio, 
      
    cast(null as INT64)
 as TotalOtherIncomeExpensesNet, 
      
    cast(null as INT64)
 as IncomeBeforeTax, 
      
    cast(null as FLOAT64)
 as IncomeBeforeTaxRatio, 
      
    cast(null as INT64)
 as IncomeTaxExpense, 
      
    cast(null as INT64)
 as NetIncome, 
      
    cast(null as FLOAT64)
 as NetIncomeRatio, 
      
    cast(null as FLOAT64)
 as EPS, 
      
    cast(null as FLOAT64)
 as EPSDiluted, 
      
    cast(null as INT64)
 as WeightedAverageShares, 
      
    cast(null as INT64)
 as WeightedAverageSharesDiluted, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:45:45.513692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:4ca820a7-96a8-4ab4-873e-cb7c2558555f&page=queryresults
[0m22:45:45.703774 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:45:45.711775 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.int_fmp__income_statement"
[0m22:45:45.712774 [debug] [Thread-1 (]: On model.public_company_overview_dbt.int_fmp__income_statement: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.int_fmp__income_statement"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`int_fmp__income_statement`
        
  (
    Ticker STRING not null,
    ReportDate DATE not null,
    Period STRING not null,
    CalendarYear INT64,
    ReportedCurrency STRING,
    CIK INT64,
    Revenue INT64,
    CostOfRevenue INT64,
    GrossProfit INT64,
    GrossProfitRatio FLOAT64,
    RnDExpenses INT64,
    GAndAExpenses INT64,
    SellingAndMarketingExpenses INT64,
    SGnAExpenses INT64,
    OtherExpenses INT64,
    OperatingExpenses INT64,
    CostAndExpenses INT64,
    InterestIncome INT64,
    InterestExpense INT64,
    DepreciationAndAmortization INT64,
    EBITDA INT64,
    EBITDARatio FLOAT64,
    OperatingIncome INT64,
    OperatingIncomeRatio FLOAT64,
    TotalOtherIncomeExpensesNet INT64,
    IncomeBeforeTax INT64,
    IncomeBeforeTaxRatio FLOAT64,
    IncomeTaxExpense INT64,
    NetIncome INT64,
    NetIncomeRatio FLOAT64,
    EPS FLOAT64,
    EPSDiluted FLOAT64,
    WeightedAverageShares INT64,
    WeightedAverageSharesDiluted INT64,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    
    primary key (Ticker, ReportDate, Period, FileTimestamp) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select Ticker, ReportDate, Period, CalendarYear, ReportedCurrency, CIK, Revenue, CostOfRevenue, GrossProfit, GrossProfitRatio, RnDExpenses, GAndAExpenses, SellingAndMarketingExpenses, SGnAExpenses, OtherExpenses, OperatingExpenses, CostAndExpenses, InterestIncome, InterestExpense, DepreciationAndAmortization, EBITDA, EBITDARatio, OperatingIncome, OperatingIncomeRatio, TotalOtherIncomeExpensesNet, IncomeBeforeTax, IncomeBeforeTaxRatio, IncomeTaxExpense, NetIncome, NetIncomeRatio, EPS, EPSDiluted, WeightedAverageShares, WeightedAverageSharesDiluted, FilingIndexLink, FilingDocumentLink, FileTimestamp, DBTLoadedAtStaging
    from (
        

WITH  __dbt__cte__stg_fmp__income_statement as (


WITH source_data AS (
    SELECT
        *,
        _FILE_NAME AS source_gcs_file_path
    FROM `public-company-overview`.`pco_dataset`.`stg_fmp__income_statement_ext`
)

SELECT
    CAST(symbol           AS STRING)             AS Ticker,
    CAST(reportedCurrency AS STRING)             AS ReportedCurrency,
    
SAFE_CAST(CAST(SAFE_CAST(cik AS FLOAT64) AS INT64) AS INT64)
                          AS CIK,

    PARSE_DATE('%Y-%m-%d', `date`)                 AS ReportDate,
    PARSE_DATE('%Y-%m-%d', fillingDate)          AS FilingDate,
    PARSE_DATETIME('%Y-%m-%d %H:%M', acceptedDate)
                                                AS AcceptedDate,

    
SAFE_CAST(CAST(SAFE_CAST(calendarYear AS FLOAT64) AS INT64) AS INT64)
                 AS CalendarYear,
    CAST(`period` AS STRING)                       AS Period,

    
SAFE_CAST(CAST(SAFE_CAST(revenue AS FLOAT64) AS INT64) AS INT64)
                      AS Revenue,
    
SAFE_CAST(CAST(SAFE_CAST(costOfRevenue AS FLOAT64) AS INT64) AS INT64)
                AS CostOfRevenue,
    
SAFE_CAST(CAST(SAFE_CAST(grossProfit AS FLOAT64) AS INT64) AS INT64)
                  AS GrossProfit,
    SAFE_CAST(grossProfitRatio AS FLOAT64)       AS GrossProfitRatio,

    
SAFE_CAST(CAST(SAFE_CAST(researchAndDevelopmentExpenses AS FLOAT64) AS INT64) AS INT64)
        AS RnDExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(generalAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
      AS GAndAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingAndMarketingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS SellingAndMarketingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(sellingGeneralAndAdministrativeExpenses AS FLOAT64) AS INT64) AS INT64)
 AS SGnAExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(otherExpenses AS FLOAT64) AS INT64) AS INT64)
               AS OtherExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(operatingExpenses AS FLOAT64) AS INT64) AS INT64)
           AS OperatingExpenses,
    
SAFE_CAST(CAST(SAFE_CAST(costAndExpenses AS FLOAT64) AS INT64) AS INT64)
             AS CostAndExpenses,

    
SAFE_CAST(CAST(SAFE_CAST(interestIncome AS FLOAT64) AS INT64) AS INT64)
              AS InterestIncome,
    
SAFE_CAST(CAST(SAFE_CAST(interestExpense AS FLOAT64) AS INT64) AS INT64)
             AS InterestExpense,
    
SAFE_CAST(CAST(SAFE_CAST(depreciationAndAmortization AS FLOAT64) AS INT64) AS INT64)
 AS DepreciationAndAmortization,

    
SAFE_CAST(CAST(SAFE_CAST(ebitda AS FLOAT64) AS INT64) AS INT64)
                      AS EBITDA,
    SAFE_CAST(ebitdaratio AS FLOAT64)           AS EBITDARatio,
    
SAFE_CAST(CAST(SAFE_CAST(operatingIncome AS FLOAT64) AS INT64) AS INT64)
             AS OperatingIncome,
    SAFE_CAST(operatingIncomeRatio AS FLOAT64)  AS OperatingIncomeRatio,
    
SAFE_CAST(CAST(SAFE_CAST(totalOtherIncomeExpensesNet AS FLOAT64) AS INT64) AS INT64)
 AS TotalOtherIncomeExpensesNet,
    
SAFE_CAST(CAST(SAFE_CAST(incomeBeforeTax AS FLOAT64) AS INT64) AS INT64)
             AS IncomeBeforeTax,
    SAFE_CAST(incomeBeforeTaxRatio AS FLOAT64)  AS IncomeBeforeTaxRatio,
    
SAFE_CAST(CAST(SAFE_CAST(incomeTaxExpense AS FLOAT64) AS INT64) AS INT64)
            AS IncomeTaxExpense,
    
SAFE_CAST(CAST(SAFE_CAST(netIncome AS FLOAT64) AS INT64) AS INT64)
                   AS NetIncome,
    SAFE_CAST(netIncomeRatio AS FLOAT64)        AS NetIncomeRatio,

    SAFE_CAST(eps AS FLOAT64)                   AS EPS,
    SAFE_CAST(epsdiluted AS FLOAT64)            AS EPSDiluted,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOut AS FLOAT64) AS INT64) AS INT64)
       AS WeightedAverageShares,
    
SAFE_CAST(CAST(SAFE_CAST(weightedAverageShsOutDil AS FLOAT64) AS INT64) AS INT64)
    AS WeightedAverageSharesDiluted,

    CAST(link      AS STRING) AS FilingIndexLink,
    CAST(finalLink AS STRING) AS FilingDocumentLink,

    PARSE_TIMESTAMP(
        '%Y%m%d_%H%M%S',
        REGEXP_EXTRACT(source_gcs_file_path, r'(\d{8}_\d{6})'),
        'America/New_York'
    ) AS FileTimestamp,

    CURRENT_TIMESTAMP() AS DBTLoadedAtStaging

FROM source_data
), stg AS (
    SELECT *
    FROM __dbt__cte__stg_fmp__income_statement 
)

SELECT
    Ticker,
    ReportDate,
    `Period`,
    CalendarYear,
    ReportedCurrency,
    CIK,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,

    FileTimestamp,
    DBTLoadedAtStaging

FROM stg


    ) as model_subq
    );
  
[0m22:45:46.019822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:b768fa02-2701-4ce3-be44-dd5ba428775d&page=queryresults
[0m22:45:48.048615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5d0b37-2b5c-4932-b1e6-060182950334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC40A30590>]}
[0m22:45:48.049617 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model pco_dataset.int_fmp__income_statement .. [[32mCREATE TABLE (2.2k rows, 1.1 MiB processed)[0m in 3.68s]
[0m22:45:48.049617 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.int_fmp__income_statement
[0m22:45:48.050615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:48.050615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:48.051615 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:45:48.051615 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:45:48.051615 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.int_fmp__income_statement' was properly closed.
[0m22:45:48.051615 [info ] [MainThread]: 
[0m22:45:48.051615 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m22:45:48.052615 [debug] [MainThread]: Command end result
[0m22:45:48.071622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:45:48.073621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:45:48.076621 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:45:48.076621 [info ] [MainThread]: 
[0m22:45:48.076621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:45:48.077622 [info ] [MainThread]: 
[0m22:45:48.077622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:45:48.078622 [debug] [MainThread]: Command `dbt run` succeeded at 22:45:48.078622 after 6.18 seconds
[0m22:45:48.078622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2D664830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2DCED3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2DCEDE80>]}
[0m22:45:48.078622 [debug] [MainThread]: Flushing usage events
[0m22:45:48.140277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:04.967217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F78287F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7659F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F756DD8B0>]}


============================== 22:49:04.970215 | 37e63abc-33f5-405b-9986-c76b9b242844 ==============================
[0m22:49:04.970215 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:49:04.970215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_project\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NesFa\\repo\\info323\\public-company-overview\\dbt_functions\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fct__income_statement', 'send_anonymous_usage_stats': 'True'}
[0m22:49:05.553537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7FEA3EF0>]}
[0m22:49:05.581537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7F900D70>]}
[0m22:49:05.582538 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:49:05.778207 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:49:05.923322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m22:49:05.923322 [debug] [MainThread]: Partial parsing: added file: public_company_overview_dbt://models\marts\fact\fct__income_statement.sql
[0m22:49:05.924322 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\_fct_models.yml
[0m22:49:05.924322 [debug] [MainThread]: Partial parsing: updated file: public_company_overview_dbt://models\marts\fact\fct__balance_sheet.sql
[0m22:49:06.130084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F79048EF0>]}
[0m22:49:06.179080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:49:06.182080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:49:06.196374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0BB8A150>]}
[0m22:49:06.197371 [info ] [MainThread]: Found 26 models, 2 seeds, 4 data tests, 11 sources, 661 macros
[0m22:49:06.197371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0BA0DBB0>]}
[0m22:49:06.198371 [info ] [MainThread]: 
[0m22:49:06.198371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:06.198371 [info ] [MainThread]: 
[0m22:49:06.199370 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:49:06.199370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview'
[0m22:49:06.200372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:07.322928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_public-company-overview_pco_dataset'
[0m22:49:07.323927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:07.550830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F78023800>]}
[0m22:49:07.551831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:07.553833 [debug] [Thread-1 (]: Began running node model.public_company_overview_dbt.fct__income_statement
[0m22:49:07.554830 [info ] [Thread-1 (]: 1 of 1 START sql table model pco_dataset.fct__income_statement ................. [RUN]
[0m22:49:07.554830 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.public_company_overview_dbt.fct__income_statement'
[0m22:49:07.555830 [debug] [Thread-1 (]: Began compiling node model.public_company_overview_dbt.fct__income_statement
[0m22:49:07.560833 [debug] [Thread-1 (]: Writing injected SQL for node "model.public_company_overview_dbt.fct__income_statement"
[0m22:49:07.561830 [debug] [Thread-1 (]: Began executing node model.public_company_overview_dbt.fct__income_statement
[0m22:49:07.581830 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__income_statement: select * from (
        

WITH source_fmp AS (
    SELECT
        *,                           
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__income_statement`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT DateDimKey, EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT TickerDimKey, Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources        s
    LEFT JOIN dim_date   d  ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t  ON s.Ticker     = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, Period
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    TickerDimKey,
    DateDimKey,
    `Period`,
    CalendarYear,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:49:07.581830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:08.077794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:af1f7f77-390b-4681-a4a8-ade54ea26e10&page=queryresults
[0m22:49:08.218457 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__income_statement: select * from (
        select
    
      
    cast(null as STRING)
 as TickerDimKey, 
      
    cast(null as INT64)
 as DateDimKey, 
      
    cast(null as STRING)
 as Period, 
      
    cast(null as INT64)
 as CalendarYear, 
      
    cast(null as INT64)
 as RecencyRank, 
      
    cast(null as INT64)
 as Revenue, 
      
    cast(null as INT64)
 as CostOfRevenue, 
      
    cast(null as INT64)
 as GrossProfit, 
      
    cast(null as FLOAT64)
 as GrossProfitRatio, 
      
    cast(null as INT64)
 as RnDExpenses, 
      
    cast(null as INT64)
 as GAndAExpenses, 
      
    cast(null as INT64)
 as SellingAndMarketingExpenses, 
      
    cast(null as INT64)
 as SGnAExpenses, 
      
    cast(null as INT64)
 as OtherExpenses, 
      
    cast(null as INT64)
 as OperatingExpenses, 
      
    cast(null as INT64)
 as CostAndExpenses, 
      
    cast(null as INT64)
 as InterestIncome, 
      
    cast(null as INT64)
 as InterestExpense, 
      
    cast(null as INT64)
 as DepreciationAndAmortization, 
      
    cast(null as INT64)
 as EBITDA, 
      
    cast(null as FLOAT64)
 as EBITDARatio, 
      
    cast(null as INT64)
 as OperatingIncome, 
      
    cast(null as FLOAT64)
 as OperatingIncomeRatio, 
      
    cast(null as INT64)
 as TotalOtherIncomeExpensesNet, 
      
    cast(null as INT64)
 as IncomeBeforeTax, 
      
    cast(null as FLOAT64)
 as IncomeBeforeTaxRatio, 
      
    cast(null as INT64)
 as IncomeTaxExpense, 
      
    cast(null as INT64)
 as NetIncome, 
      
    cast(null as FLOAT64)
 as NetIncomeRatio, 
      
    cast(null as FLOAT64)
 as EPS, 
      
    cast(null as FLOAT64)
 as EPSDiluted, 
      
    cast(null as INT64)
 as WeightedAverageShares, 
      
    cast(null as INT64)
 as WeightedAverageSharesDiluted, 
      
    cast(null as TIMESTAMP)
 as FileTimestamp, 
      
    cast(null as TIMESTAMP)
 as DBTLoadedAtStaging, 
      
    cast(null as STRING)
 as FilingIndexLink, 
      
    cast(null as STRING)
 as FilingDocumentLink, 
      
    cast(null as STRING)
 as DataSource
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:49:08.742887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:US:e32555f2-ac80-48d0-8d5f-18e9cee21d2f&page=queryresults
[0m22:49:08.946142 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:49:08.947142 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type foreign_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:49:08.951142 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:49:08.959144 [debug] [Thread-1 (]: Writing runtime sql for node "model.public_company_overview_dbt.fct__income_statement"
[0m22:49:08.960142 [debug] [Thread-1 (]: On model.public_company_overview_dbt.fct__income_statement: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "public_company_overview", "target_name": "dev", "node_id": "model.public_company_overview_dbt.fct__income_statement"} */

  
    

    create or replace table `public-company-overview`.`pco_dataset`.`fct__income_statement`
        
  (
    TickerDimKey STRING not null references `public-company-overview`.`pco_dataset`.`dim__tickers` (TickerDimKey) not enforced,
    DateDimKey INT64 not null references `public-company-overview`.`pco_dataset`.`dim__date` (DateDimKey) not enforced,
    Period STRING not null,
    CalendarYear INT64,
    RecencyRank INT64,
    Revenue INT64,
    CostOfRevenue INT64,
    GrossProfit INT64,
    GrossProfitRatio FLOAT64,
    RnDExpenses INT64,
    GAndAExpenses INT64,
    SellingAndMarketingExpenses INT64,
    SGnAExpenses INT64,
    OtherExpenses INT64,
    OperatingExpenses INT64,
    CostAndExpenses INT64,
    InterestIncome INT64,
    InterestExpense INT64,
    DepreciationAndAmortization INT64,
    EBITDA INT64,
    EBITDARatio FLOAT64,
    OperatingIncome INT64,
    OperatingIncomeRatio FLOAT64,
    TotalOtherIncomeExpensesNet INT64,
    IncomeBeforeTax INT64,
    IncomeBeforeTaxRatio FLOAT64,
    IncomeTaxExpense INT64,
    NetIncome INT64,
    NetIncomeRatio FLOAT64,
    EPS FLOAT64,
    EPSDiluted FLOAT64,
    WeightedAverageShares INT64,
    WeightedAverageSharesDiluted INT64,
    FileTimestamp TIMESTAMP not null,
    DBTLoadedAtStaging TIMESTAMP not null,
    FilingIndexLink STRING,
    FilingDocumentLink STRING,
    DataSource STRING,
    
    primary key (TickerDimKey, DateDimKey, Period, RecencyRank) not enforced
    )

      
    
    cluster by TickerDimKey, DateDimKey

    OPTIONS()
    as (
      
    select TickerDimKey, DateDimKey, Period, CalendarYear, RecencyRank, Revenue, CostOfRevenue, GrossProfit, GrossProfitRatio, RnDExpenses, GAndAExpenses, SellingAndMarketingExpenses, SGnAExpenses, OtherExpenses, OperatingExpenses, CostAndExpenses, InterestIncome, InterestExpense, DepreciationAndAmortization, EBITDA, EBITDARatio, OperatingIncome, OperatingIncomeRatio, TotalOtherIncomeExpensesNet, IncomeBeforeTax, IncomeBeforeTaxRatio, IncomeTaxExpense, NetIncome, NetIncomeRatio, EPS, EPSDiluted, WeightedAverageShares, WeightedAverageSharesDiluted, FileTimestamp, DBTLoadedAtStaging, FilingIndexLink, FilingDocumentLink, DataSource
    from (
        

WITH source_fmp AS (
    SELECT
        *,                           
        'FMP' AS DataSource
    FROM `public-company-overview`.`pco_dataset`.`int_fmp__income_statement`
),

all_sources AS (
    SELECT * FROM source_fmp
),

dim_date AS (
    SELECT DateDimKey, EventDate
    FROM `public-company-overview`.`pco_dataset`.`dim__date`
),

dim_ticker AS (
    SELECT TickerDimKey, Ticker
    FROM `public-company-overview`.`pco_dataset`.`dim__tickers`
),

joined AS (
    SELECT
        s.*,
        d.DateDimKey,
        t.TickerDimKey
    FROM all_sources        s
    LEFT JOIN dim_date   d  ON s.ReportDate = d.EventDate
    LEFT JOIN dim_ticker t  ON s.Ticker     = t.Ticker
),

ranked AS (
    SELECT
        *,
        DENSE_RANK() OVER (
            PARTITION BY TickerDimKey, DateDimKey, Period
            ORDER BY FileTimestamp DESC
        ) AS RecencyRank
    FROM joined
)

SELECT
    TickerDimKey,
    DateDimKey,
    `Period`,
    CalendarYear,

    Revenue,
    CostOfRevenue,
    GrossProfit,
    GrossProfitRatio,

    RnDExpenses,
    GAndAExpenses,
    SellingAndMarketingExpenses,
    SGnAExpenses,
    OtherExpenses,
    OperatingExpenses,
    CostAndExpenses,

    InterestIncome,
    InterestExpense,
    DepreciationAndAmortization,

    EBITDA,
    EBITDARatio,
    OperatingIncome,
    OperatingIncomeRatio,
    TotalOtherIncomeExpensesNet,
    IncomeBeforeTax,
    IncomeBeforeTaxRatio,
    IncomeTaxExpense,
    NetIncome,
    NetIncomeRatio,

    EPS,
    EPSDiluted,
    WeightedAverageShares,
    WeightedAverageSharesDiluted,

    FilingIndexLink,
    FilingDocumentLink,
    FileTimestamp,
    DBTLoadedAtStaging,
    DataSource,
    RecencyRank

FROM ranked
WHERE RecencyRank = 1
    ) as model_subq
    );
  
[0m22:49:09.215877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=public-company-overview&j=bq:us-east1:e44fb032-1b2c-4ff3-837a-31bcc7b9c5c2&page=queryresults
[0m22:49:11.361408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e63abc-33f5-405b-9986-c76b9b242844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0B216060>]}
[0m22:49:11.362411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pco_dataset.fct__income_statement ............ [[32mCREATE TABLE (1.6k rows, 3.2 MiB processed)[0m in 3.81s]
[0m22:49:11.362411 [debug] [Thread-1 (]: Finished running node model.public_company_overview_dbt.fct__income_statement
[0m22:49:11.363409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:11.364409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:11.364409 [debug] [MainThread]: Connection 'list_public-company-overview' was properly closed.
[0m22:49:11.364409 [debug] [MainThread]: Connection 'list_public-company-overview_pco_dataset' was properly closed.
[0m22:49:11.364409 [debug] [MainThread]: Connection 'model.public_company_overview_dbt.fct__income_statement' was properly closed.
[0m22:49:11.364409 [info ] [MainThread]: 
[0m22:49:11.365409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m22:49:11.365409 [debug] [MainThread]: Command end result
[0m22:49:11.385409 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\manifest.json
[0m22:49:11.386410 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\semantic_manifest.json
[0m22:49:11.389411 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\NesFa\repo\info323\public-company-overview\dbt_functions\target\run_results.json
[0m22:49:11.389411 [info ] [MainThread]: 
[0m22:49:11.389411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:11.390409 [info ] [MainThread]: 
[0m22:49:11.390409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:49:11.391409 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:11.391409 after 6.53 seconds
[0m22:49:11.391409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F78EB2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0B988B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0B592060>]}
[0m22:49:11.391409 [debug] [MainThread]: Flushing usage events
[0m22:49:11.614329 [debug] [MainThread]: An error was encountered while trying to flush usage events
