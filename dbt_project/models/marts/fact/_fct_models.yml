version: 2

models:
  - name: fct__hist_ticker
    description: "Fact model for historical stock tickers"
    config:
      contract:
        enforced: true
      on_schema_change: "append_new_columns"
    constraints:
          - type: primary_key
            columns: [TickerDimKey, DateDimKey, TimeDimKey, IntervalDimKey, RecencyRank]
    columns:
      - name: Open
        data_type: FLOAT64
      - name: High
        data_type: FLOAT64
      - name: Low
        data_type: FLOAT64
      - name: Close
        data_type: FLOAT64
      - name: Volume
        data_type: INT64
      - name: Vwap
        data_type: FLOAT64
      - name: Change
        data_type: FLOAT64
      - name: ChangePercent
        data_type: FLOAT64
      - name: NumTransactions
        data_type: INT64
      - name: Dividends
        data_type: FLOAT64
      - name: StockSplits
        data_type: FLOAT64
      - name: FileTimestamp
        data_type: TIMESTAMP
        constraints:
          - type: not_null
      - name: DBTLoadedAtStaging
        data_type: TIMESTAMP
        constraints:
          - type: not_null
      - name: RecencyRank
        data_type: INT64
      - name: IntervalDimKey
        data_type: STRING
        constraints:
          - type: not_null
          - type: foreign_key
            to: ref('dim__interval')
            to_columns: [IntervalDimKey]
      - name: DataSource
        data_type: STRING
      - name: DateDimKey
        data_type: INT64
        constraints:
          - type: not_null
          - type: foreign_key
            to: ref('dim__date')
            to_columns: [DateDimKey]
      - name: TimeDimKey
        data_type: INT64
        constraints:
          - type: not_null
          - type: foreign_key
            to: ref('dim__time')
            to_columns: [TimeDimKey]
      - name: TickerDimKey
        data_type: STRING
        constraints:
          - type: not_null
          - type: foreign_key
            to: ref('dim__tickers')
            to_columns: [TickerDimKey]
